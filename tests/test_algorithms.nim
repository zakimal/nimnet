import unittest

import tables

import nimnet
import nimnet/generators
import nimnet/algorithms

const DELTA = 1e-15
proc equal(a, b: float): bool =
  if DELTA < abs(a - b):
      return false
  return true

# -------------------------------------------------------------------
# Approximations and Heuristics
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Assortativity
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Asteroidal
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Bipartite
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Boundary
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Centrality
# -------------------------------------------------------------------

test "degree centrality for undirected graph":
  let karate = karateClubGraph()
  let got = degreeCentrality(karate)
  let expected = {0: 0.48484848484848486, 1: 0.2727272727272727, 2: 0.30303030303030304, 3: 0.18181818181818182, 4: 0.09090909090909091, 5: 0.12121212121212122, 6: 0.12121212121212122, 7: 0.12121212121212122, 8: 0.15151515151515152, 9: 0.06060606060606061, 10: 0.09090909090909091, 11: 0.030303030303030304, 12: 0.06060606060606061, 13: 0.15151515151515152, 14: 0.06060606060606061, 15: 0.06060606060606061, 16: 0.06060606060606061, 17: 0.06060606060606061, 18: 0.06060606060606061, 19: 0.09090909090909091, 20: 0.06060606060606061, 21: 0.06060606060606061, 22: 0.06060606060606061, 23: 0.15151515151515152, 24: 0.09090909090909091, 25: 0.09090909090909091, 26: 0.06060606060606061, 27: 0.12121212121212122, 28: 0.09090909090909091, 29: 0.12121212121212122, 30: 0.12121212121212122, 31: 0.18181818181818182, 32: 0.36363636363636365, 33: 0.5151515151515151}.toTable()
  for (node, val) in got.pairs():
    check equal(val, expected[node]) == true

test "in-degree centrality for directed graph":
  let dkarate = newDiGraph(karateClubGraph().edges())
  let got = inDegreeCentrality(dkarate)
  let expected = {0: 0.0, 1: 0.030303030303030304, 2: 0.06060606060606061, 3: 0.09090909090909091, 4: 0.030303030303030304, 5: 0.030303030303030304, 6: 0.09090909090909091, 7: 0.12121212121212122, 8: 0.06060606060606061, 10: 0.09090909090909091, 11: 0.030303030303030304, 12: 0.06060606060606061, 13: 0.12121212121212122, 17: 0.06060606060606061, 19: 0.06060606060606061, 21: 0.06060606060606061, 31: 0.12121212121212122, 30: 0.06060606060606061, 9: 0.030303030303030304, 27: 0.09090909090909091, 28: 0.030303030303030304, 32: 0.33333333333333337, 16: 0.06060606060606061, 33: 0.5151515151515151, 14: 0.0, 15: 0.0, 18: 0.0, 20: 0.0, 22: 0.0, 23: 0.0, 25: 0.06060606060606061, 29: 0.06060606060606061, 24: 0.0, 26: 0.0}.toTable()
  for (node, val) in got.pairs():
    check equal(val, expected[node]) == true

test "out-degree centrality for directed graph":
  let dkarate = newDiGraph(karateClubGraph().edges())
  let got = outDegreeCentrality(dkarate)
  let expected = {0: 0.48484848484848486, 1: 0.24242424242424243, 2: 0.24242424242424243, 3: 0.09090909090909091, 4: 0.06060606060606061, 5: 0.09090909090909091, 6: 0.030303030303030304, 7: 0.0, 8: 0.09090909090909091, 10: 0.0, 11: 0.0, 12: 0.0, 13: 0.030303030303030304, 17: 0.0, 19: 0.030303030303030304, 21: 0.0, 31: 0.06060606060606061, 30: 0.06060606060606061, 9: 0.030303030303030304, 27: 0.030303030303030304, 28: 0.06060606060606061, 32: 0.030303030303030304, 16: 0.0, 33: 0.0, 14: 0.06060606060606061, 15: 0.06060606060606061, 18: 0.06060606060606061, 20: 0.06060606060606061, 22: 0.06060606060606061, 23: 0.15151515151515152, 25: 0.030303030303030304, 29: 0.06060606060606061, 24: 0.09090909090909091, 26: 0.06060606060606061}.toTable()
  for (node, val) in got.pairs():
    check equal(val, expected[node]) == true

# -------------------------------------------------------------------
# Chains
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Chordal
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Clique
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Clutering
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Coloring
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Communicability
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Communities
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Components
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Connectivity
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Cores
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Covering
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Cycle
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Cuts
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# D-Separation
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# DAG
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Distance Measures
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Distance-Regular Graphs
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Dominance
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Dominating Sets
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Efficiency
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Eulerian
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Flows
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Graph Hashing
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Graphical Degree Sequence
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Hierarchy
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Hybrid
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Isolates
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Isomorphism
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Link Analysis
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Link Prediction
# -------------------------------------------------------------------

test "resource allocation index":
  let karate = karateClubGraph()
  let got = resourceAllocationIndex(karate)
  let expected: seq[tuple[edge: Edge, prediction: float]] = @[
    ((0, 9), 0.1),
    ((0, 14), 0.0),
    ((0, 15), 0.0),
    ((0, 16), 0.5),
    ((0, 18), 0.0),
    ((0, 20), 0.0),
    ((0, 22), 0.0),
    ((0, 23), 0.0),
    ((0, 24), 0.16666666666666666),
    ((0, 25), 0.16666666666666666),
    ((0, 26), 0.0),
    ((0, 27), 0.1),
    ((0, 28), 0.26666666666666666),
    ((0, 29), 0.0),
    ((0, 30), 0.3111111111111111),
    ((0, 32), 0.4666666666666667),
    ((0, 33), 0.9),
    ((1, 4), 0.0625),
    ((1, 5), 0.0625),
    ((1, 6), 0.0625),
    ((1, 8), 0.4125),
    ((1, 9), 0.1),
    ((1, 10), 0.0625),
    ((1, 11), 0.0625),
    ((1, 12), 0.22916666666666666),
    ((1, 14), 0.0),
    ((1, 15), 0.0),
    ((1, 16), 0.0),
    ((1, 18), 0.0),
    ((1, 20), 0.0),
    ((1, 22), 0.0),
    ((1, 23), 0.0),
    ((1, 24), 0.0),
    ((1, 25), 0.0),
    ((1, 26), 0.0),
    ((1, 27), 0.1),
    ((1, 28), 0.1),
    ((1, 29), 0.0),
    ((1, 31), 0.0625),
    ((1, 32), 0.35),
    ((1, 33), 0.7833333333333333),
    ((2, 4), 0.0625),
    ((2, 5), 0.0625),
    ((2, 6), 0.0625),
    ((2, 10), 0.0625),
    ((2, 11), 0.0625),
    ((2, 12), 0.22916666666666666),
    ((2, 14), 0.08333333333333333),
    ((2, 15), 0.08333333333333333),
    ((2, 16), 0.0),
    ((2, 17), 0.1736111111111111),
    ((2, 18), 0.08333333333333333),
    ((2, 19), 0.1736111111111111),
    ((2, 20), 0.08333333333333333),
    ((2, 21), 0.1736111111111111),
    ((2, 22), 0.08333333333333333),
    ((2, 23), 0.3333333333333333),
    ((2, 24), 0.25),
    ((2, 25), 0.0),
    ((2, 26), 0.0),
    ((2, 29), 0.08333333333333333),
    ((2, 30), 0.39444444444444443),
    ((2, 31), 0.47916666666666663),
    ((2, 33), 1.5666666666666664),
    ((3, 4), 0.0625),
    ((3, 5), 0.0625),
    ((3, 6), 0.0625),
    ((3, 8), 0.1625),
    ((3, 9), 0.1),
    ((3, 10), 0.0625),
    ((3, 11), 0.0625),
    ((3, 14), 0.0),
    ((3, 15), 0.0),
    ((3, 16), 0.0),
    ((3, 17), 0.1736111111111111),
    ((3, 18), 0.0),
    ((3, 19), 0.1736111111111111),
    ((3, 20), 0.0),
    ((3, 21), 0.1736111111111111),
    ((3, 22), 0.0),
    ((3, 23), 0.0),
    ((3, 24), 0.0),
    ((3, 25), 0.0),
    ((3, 26), 0.0),
    ((3, 27), 0.1),
    ((3, 28), 0.1),
    ((3, 29), 0.0),
    ((3, 30), 0.1111111111111111),
    ((3, 31), 0.0625),
    ((3, 32), 0.1),
    ((3, 33), 0.2),
    ((4, 5), 0.6458333333333333),
    ((4, 7), 0.0625),
    ((4, 8), 0.0625),
    ((4, 9), 0.0),
    ((4, 11), 0.0625),
    ((4, 12), 0.0625),
    ((4, 13), 0.0625),
    ((4, 14), 0.0),
    ((4, 15), 0.0),
    ((4, 16), 0.25),
    ((4, 17), 0.0625),
    ((4, 18), 0.0),
    ((4, 19), 0.0625),
    ((4, 20), 0.0),
    ((4, 21), 0.0625),
    ((4, 22), 0.0),
    ((4, 23), 0.0),
    ((4, 24), 0.0),
    ((4, 25), 0.0),
    ((4, 26), 0.0),
    ((4, 27), 0.0),
    ((4, 28), 0.0),
    ((4, 29), 0.0),
    ((4, 30), 0.0),
    ((4, 31), 0.0625),
    ((4, 32), 0.0),
    ((4, 33), 0.0),
    ((5, 7), 0.0625),
    ((5, 8), 0.0625),
    ((5, 9), 0.0),
    ((5, 11), 0.0625),
    ((5, 12), 0.0625),
    ((5, 13), 0.0625),
    ((5, 14), 0.0),
    ((5, 15), 0.0),
    ((5, 17), 0.0625),
    ((5, 18), 0.0),
    ((5, 19), 0.0625),
    ((5, 20), 0.0),
    ((5, 21), 0.0625),
    ((5, 22), 0.0),
    ((5, 23), 0.0),
    ((5, 24), 0.0),
    ((5, 25), 0.0),
    ((5, 26), 0.0),
    ((5, 27), 0.0),
    ((5, 28), 0.0),
    ((5, 29), 0.0),
    ((5, 30), 0.0),
    ((5, 31), 0.0625),
    ((5, 32), 0.0),
    ((5, 33), 0.0),
    ((6, 7), 0.0625),
    ((6, 8), 0.0625),
    ((6, 9), 0.0),
    ((6, 10), 0.6458333333333333),
    ((6, 11), 0.0625),
    ((6, 12), 0.0625),
    ((6, 13), 0.0625),
    ((6, 14), 0.0),
    ((6, 15), 0.0),
    ((6, 17), 0.0625),
    ((6, 18), 0.0),
    ((6, 19), 0.0625),
    ((6, 20), 0.0),
    ((6, 21), 0.0625),
    ((6, 22), 0.0),
    ((6, 23), 0.0),
    ((6, 24), 0.0),
    ((6, 25), 0.0),
    ((6, 26), 0.0),
    ((6, 27), 0.0),
    ((6, 28), 0.0),
    ((6, 29), 0.0),
    ((6, 30), 0.0),
    ((6, 31), 0.0625),
    ((6, 32), 0.0),
    ((6, 33), 0.0),
    ((7, 8), 0.1625),
    ((7, 9), 0.1),
    ((7, 10), 0.0625),
    ((7, 11), 0.0625),
    ((7, 12), 0.22916666666666666),
    ((7, 13), 0.44027777777777777),
    ((7, 14), 0.0),
    ((7, 15), 0.0),
    ((7, 16), 0.0),
    ((7, 17), 0.1736111111111111),
    ((7, 18), 0.0),
    ((7, 19), 0.1736111111111111),
    ((7, 20), 0.0),
    ((7, 21), 0.1736111111111111),
    ((7, 22), 0.0),
    ((7, 23), 0.0),
    ((7, 24), 0.0),
    ((7, 25), 0.0),
    ((7, 26), 0.0),
    ((7, 27), 0.1),
    ((7, 28), 0.1),
    ((7, 29), 0.0),
    ((7, 30), 0.1111111111111111),
    ((7, 31), 0.0625),
    ((7, 32), 0.1),
    ((7, 33), 0.0),
    ((8, 9), 0.1588235294117647),
    ((8, 10), 0.0625),
    ((8, 11), 0.0625),
    ((8, 12), 0.0625),
    ((8, 13), 0.2213235294117647),
    ((8, 14), 0.14215686274509803),
    ((8, 15), 0.14215686274509803),
    ((8, 16), 0.0),
    ((8, 17), 0.0625),
    ((8, 18), 0.14215686274509803),
    ((8, 19), 0.1213235294117647),
    ((8, 20), 0.14215686274509803),
    ((8, 21), 0.0625),
    ((8, 22), 0.14215686274509803),
    ((8, 23), 0.14215686274509803),
    ((8, 24), 0.0),
    ((8, 25), 0.0),
    ((8, 26), 0.058823529411764705),
    ((8, 27), 0.1588235294117647),
    ((8, 28), 0.1588235294117647),
    ((8, 29), 0.14215686274509803),
    ((8, 31), 0.20465686274509803),
    ((9, 10), 0.0),
    ((9, 11), 0.0),
    ((9, 12), 0.0),
    ((9, 13), 0.1588235294117647),
    ((9, 14), 0.058823529411764705),
    ((9, 15), 0.058823529411764705),
    ((9, 16), 0.0),
    ((9, 17), 0.0),
    ((9, 18), 0.058823529411764705),
    ((9, 19), 0.058823529411764705),
    ((9, 20), 0.058823529411764705),
    ((9, 21), 0.0),
    ((9, 22), 0.058823529411764705),
    ((9, 23), 0.058823529411764705),
    ((9, 24), 0.0),
    ((9, 25), 0.0),
    ((9, 26), 0.058823529411764705),
    ((9, 27), 0.1588235294117647),
    ((9, 28), 0.1588235294117647),
    ((9, 29), 0.058823529411764705),
    ((9, 30), 0.058823529411764705),
    ((9, 31), 0.058823529411764705),
    ((9, 32), 0.1588235294117647),
    ((10, 11), 0.0625),
    ((10, 12), 0.0625),
    ((10, 13), 0.0625),
    ((10, 14), 0.0),
    ((10, 15), 0.0),
    ((10, 16), 0.25),
    ((10, 17), 0.0625),
    ((10, 18), 0.0),
    ((10, 19), 0.0625),
    ((10, 20), 0.0),
    ((10, 21), 0.0625),
    ((10, 22), 0.0),
    ((10, 23), 0.0),
    ((10, 24), 0.0),
    ((10, 25), 0.0),
    ((10, 26), 0.0),
    ((10, 27), 0.0),
    ((10, 28), 0.0),
    ((10, 29), 0.0),
    ((10, 30), 0.0),
    ((10, 31), 0.0625),
    ((10, 32), 0.0),
    ((10, 33), 0.0),
    ((11, 12), 0.0625),
    ((11, 13), 0.0625),
    ((11, 14), 0.0),
    ((11, 15), 0.0),
    ((11, 16), 0.0),
    ((11, 17), 0.0625),
    ((11, 18), 0.0),
    ((11, 19), 0.0625),
    ((11, 20), 0.0),
    ((11, 21), 0.0625),
    ((11, 22), 0.0),
    ((11, 23), 0.0),
    ((11, 24), 0.0),
    ((11, 25), 0.0),
    ((11, 26), 0.0),
    ((11, 27), 0.0),
    ((11, 28), 0.0),
    ((11, 29), 0.0),
    ((11, 30), 0.0),
    ((11, 31), 0.0625),
    ((11, 32), 0.0),
    ((11, 33), 0.0),
    ((12, 13), 0.22916666666666666),
    ((12, 14), 0.0),
    ((12, 15), 0.0),
    ((12, 16), 0.0),
    ((12, 17), 0.0625),
    ((12, 18), 0.0),
    ((12, 19), 0.0625),
    ((12, 20), 0.0),
    ((12, 21), 0.0625),
    ((12, 22), 0.0),
    ((12, 23), 0.0),
    ((12, 24), 0.0),
    ((12, 25), 0.0),
    ((12, 26), 0.0),
    ((12, 27), 0.0),
    ((12, 28), 0.0),
    ((12, 29), 0.0),
    ((12, 30), 0.0),
    ((12, 31), 0.0625),
    ((12, 32), 0.0),
    ((12, 33), 0.0),
    ((13, 14), 0.058823529411764705),
    ((13, 15), 0.058823529411764705),
    ((13, 16), 0.0),
    ((13, 17), 0.1736111111111111),
    ((13, 18), 0.058823529411764705),
    ((13, 19), 0.23243464052287582),
    ((13, 20), 0.058823529411764705),
    ((13, 21), 0.1736111111111111),
    ((13, 22), 0.058823529411764705),
    ((13, 23), 0.058823529411764705),
    ((13, 24), 0.0),
    ((13, 25), 0.0),
    ((13, 26), 0.058823529411764705),
    ((13, 27), 0.1588235294117647),
    ((13, 28), 0.1588235294117647),
    ((13, 29), 0.058823529411764705),
    ((13, 30), 0.16993464052287582),
    ((13, 31), 0.1213235294117647),
    ((13, 32), 0.1588235294117647),
    ((14, 15), 0.14215686274509803),
    ((14, 16), 0.0),
    ((14, 17), 0.0),
    ((14, 18), 0.14215686274509803),
    ((14, 19), 0.058823529411764705),
    ((14, 20), 0.14215686274509803),
    ((14, 21), 0.0),
    ((14, 22), 0.14215686274509803),
    ((14, 23), 0.14215686274509803),
    ((14, 24), 0.0),
    ((14, 25), 0.0),
    ((14, 26), 0.058823529411764705),
    ((14, 27), 0.058823529411764705),
    ((14, 28), 0.058823529411764705),
    ((14, 29), 0.14215686274509803),
    ((14, 30), 0.14215686274509803),
    ((14, 31), 0.14215686274509803),
    ((15, 16), 0.0),
    ((15, 17), 0.0),
    ((15, 18), 0.14215686274509803),
    ((15, 19), 0.058823529411764705),
    ((15, 20), 0.14215686274509803),
    ((15, 21), 0.0),
    ((15, 22), 0.14215686274509803),
    ((15, 23), 0.14215686274509803),
    ((15, 24), 0.0),
    ((15, 25), 0.0),
    ((15, 26), 0.058823529411764705),
    ((15, 27), 0.058823529411764705),
    ((15, 28), 0.058823529411764705),
    ((15, 29), 0.14215686274509803),
    ((15, 30), 0.14215686274509803),
    ((15, 31), 0.14215686274509803),
    ((16, 17), 0.0),
    ((16, 18), 0.0),
    ((16, 19), 0.0),
    ((16, 20), 0.0),
    ((16, 21), 0.0),
    ((16, 22), 0.0),
    ((16, 23), 0.0),
    ((16, 24), 0.0),
    ((16, 25), 0.0),
    ((16, 26), 0.0),
    ((16, 27), 0.0),
    ((16, 28), 0.0),
    ((16, 29), 0.0),
    ((16, 30), 0.0),
    ((16, 31), 0.0),
    ((16, 32), 0.0),
    ((16, 33), 0.0),
    ((17, 18), 0.0),
    ((17, 19), 0.1736111111111111),
    ((17, 20), 0.0),
    ((17, 21), 0.1736111111111111),
    ((17, 22), 0.0),
    ((17, 23), 0.0),
    ((17, 24), 0.0),
    ((17, 25), 0.0),
    ((17, 26), 0.0),
    ((17, 27), 0.0),
    ((17, 28), 0.0),
    ((17, 29), 0.0),
    ((17, 30), 0.1111111111111111),
    ((17, 31), 0.0625),
    ((17, 32), 0.0),
    ((17, 33), 0.0),
    ((18, 19), 0.058823529411764705),
    ((18, 20), 0.14215686274509803),
    ((18, 21), 0.0),
    ((18, 22), 0.14215686274509803),
    ((18, 23), 0.14215686274509803),
    ((18, 24), 0.0),
    ((18, 25), 0.0),
    ((18, 26), 0.058823529411764705),
    ((18, 27), 0.058823529411764705),
    ((18, 28), 0.058823529411764705),
    ((18, 29), 0.14215686274509803),
    ((18, 30), 0.14215686274509803),
    ((18, 31), 0.14215686274509803),
    ((19, 20), 0.058823529411764705),
    ((19, 21), 0.1736111111111111),
    ((19, 22), 0.058823529411764705),
    ((19, 23), 0.058823529411764705),
    ((19, 24), 0.0),
    ((19, 25), 0.0),
    ((19, 26), 0.058823529411764705),
    ((19, 27), 0.058823529411764705),
    ((19, 28), 0.058823529411764705),
    ((19, 29), 0.058823529411764705),
    ((19, 30), 0.16993464052287582),
    ((19, 31), 0.1213235294117647),
    ((19, 32), 0.058823529411764705),
    ((20, 21), 0.0),
    ((20, 22), 0.14215686274509803),
    ((20, 23), 0.14215686274509803),
    ((20, 24), 0.0),
    ((20, 25), 0.0),
    ((20, 26), 0.058823529411764705),
    ((20, 27), 0.058823529411764705),
    ((20, 28), 0.058823529411764705),
    ((20, 29), 0.14215686274509803),
    ((20, 30), 0.14215686274509803),
    ((20, 31), 0.14215686274509803),
    ((21, 22), 0.0),
    ((21, 23), 0.0),
    ((21, 24), 0.0),
    ((21, 25), 0.0),
    ((21, 26), 0.0),
    ((21, 27), 0.0),
    ((21, 28), 0.0),
    ((21, 29), 0.0),
    ((21, 30), 0.1111111111111111),
    ((21, 31), 0.0625),
    ((21, 32), 0.0),
    ((21, 33), 0.0),
    ((22, 23), 0.14215686274509803),
    ((22, 24), 0.0),
    ((22, 25), 0.0),
    ((22, 26), 0.058823529411764705),
    ((22, 27), 0.058823529411764705),
    ((22, 28), 0.058823529411764705),
    ((22, 29), 0.14215686274509803),
    ((22, 30), 0.14215686274509803),
    ((22, 31), 0.14215686274509803),
    ((23, 24), 0.5833333333333333),
    ((23, 26), 0.3088235294117647),
    ((23, 28), 0.058823529411764705),
    ((23, 30), 0.14215686274509803),
    ((23, 31), 0.47549019607843135),
    ((24, 26), 0.0),
    ((24, 28), 0.16666666666666666),
    ((24, 29), 0.0),
    ((24, 30), 0.0),
    ((24, 32), 0.16666666666666666),
    ((24, 33), 0.41666666666666663),
    ((25, 26), 0.0),
    ((25, 27), 0.5333333333333333),
    ((25, 28), 0.16666666666666666),
    ((25, 29), 0.2),
    ((25, 30), 0.0),
    ((25, 32), 0.3666666666666667),
    ((25, 33), 0.3666666666666667),
    ((26, 27), 0.058823529411764705),
    ((26, 28), 0.058823529411764705),
    ((26, 30), 0.058823529411764705),
    ((26, 31), 0.058823529411764705),
    ((26, 32), 0.3088235294117647),
    ((27, 28), 0.1588235294117647),
    ((27, 29), 0.25882352941176473),
    ((27, 30), 0.058823529411764705),
    ((27, 31), 0.39215686274509803),
    ((27, 32), 0.35882352941176476),
    ((28, 29), 0.058823529411764705),
    ((28, 30), 0.058823529411764705),
    ((28, 32), 0.3254901960784314),
    ((29, 30), 0.14215686274509803),
    ((29, 31), 0.14215686274509803),
    ((30, 31), 0.14215686274509803)
  ]
  for i in 0..<len(got):
    check (got[i].edge == expected[i].edge and equal(got[i].prediction, expected[i].prediction)) == true

test "jaccard coefficient":
  let karate = karateClubGraph()
  let got = jaccardCoefficient(karate)
  let expected: seq[tuple[edge: Edge, prediction: float]] = @[
    ((0, 9), 0.058823529411764705),
    ((0, 14), 0.0),
    ((0, 15), 0.0),
    ((0, 16), 0.125),
    ((0, 18), 0.0),
    ((0, 20), 0.0),
    ((0, 22), 0.0),
    ((0, 23), 0.0),
    ((0, 24), 0.05555555555555555),
    ((0, 25), 0.05555555555555555),
    ((0, 26), 0.0),
    ((0, 27), 0.05263157894736842),
    ((0, 28), 0.11764705882352941),
    ((0, 29), 0.0),
    ((0, 30), 0.1111111111111111),
    ((0, 32), 0.12),
    ((0, 33), 0.13793103448275862),
    ((1, 4), 0.09090909090909091),
    ((1, 5), 0.08333333333333333),
    ((1, 6), 0.08333333333333333),
    ((1, 8), 0.2727272727272727),
    ((1, 9), 0.1),
    ((1, 10), 0.09090909090909091),
    ((1, 11), 0.1111111111111111),
    ((1, 12), 0.2222222222222222),
    ((1, 14), 0.0),
    ((1, 15), 0.0),
    ((1, 16), 0.0),
    ((1, 18), 0.0),
    ((1, 20), 0.0),
    ((1, 22), 0.0),
    ((1, 23), 0.0),
    ((1, 24), 0.0),
    ((1, 25), 0.0),
    ((1, 26), 0.0),
    ((1, 27), 0.08333333333333333),
    ((1, 28), 0.09090909090909091),
    ((1, 29), 0.0),
    ((1, 31), 0.07142857142857142),
    ((1, 32), 0.10526315789473684),
    ((1, 33), 0.13043478260869565),
    ((2, 4), 0.08333333333333333),
    ((2, 5), 0.07692307692307693),
    ((2, 6), 0.07692307692307693),
    ((2, 10), 0.08333333333333333),
    ((2, 11), 0.1),
    ((2, 12), 0.2),
    ((2, 14), 0.09090909090909091),
    ((2, 15), 0.09090909090909091),
    ((2, 16), 0.0),
    ((2, 17), 0.2),
    ((2, 18), 0.09090909090909091),
    ((2, 19), 0.18181818181818182),
    ((2, 20), 0.09090909090909091),
    ((2, 21), 0.2),
    ((2, 22), 0.09090909090909091),
    ((2, 23), 0.15384615384615385),
    ((2, 24), 0.08333333333333333),
    ((2, 25), 0.0),
    ((2, 26), 0.0),
    ((2, 29), 0.07692307692307693),
    ((2, 30), 0.2727272727272727),
    ((2, 31), 0.23076923076923078),
    ((2, 33), 0.2857142857142857),
    ((3, 4), 0.125),
    ((3, 5), 0.1111111111111111),
    ((3, 6), 0.1111111111111111),
    ((3, 8), 0.2222222222222222),
    ((3, 9), 0.14285714285714285),
    ((3, 10), 0.125),
    ((3, 11), 0.16666666666666666),
    ((3, 14), 0.0),
    ((3, 15), 0.0),
    ((3, 16), 0.0),
    ((3, 17), 0.3333333333333333),
    ((3, 18), 0.0),
    ((3, 19), 0.2857142857142857),
    ((3, 20), 0.0),
    ((3, 21), 0.3333333333333333),
    ((3, 22), 0.0),
    ((3, 23), 0.0),
    ((3, 24), 0.0),
    ((3, 25), 0.0),
    ((3, 26), 0.0),
    ((3, 27), 0.1111111111111111),
    ((3, 28), 0.125),
    ((3, 29), 0.0),
    ((3, 30), 0.1111111111111111),
    ((3, 31), 0.09090909090909091),
    ((3, 32), 0.058823529411764705),
    ((3, 33), 0.045454545454545456),
    ((4, 5), 0.75),
    ((4, 7), 0.16666666666666666),
    ((4, 8), 0.14285714285714285),
    ((4, 9), 0.0),
    ((4, 11), 0.3333333333333333),
    ((4, 12), 0.25),
    ((4, 13), 0.14285714285714285),
    ((4, 14), 0.0),
    ((4, 15), 0.0),
    ((4, 16), 0.25),
    ((4, 17), 0.25),
    ((4, 18), 0.0),
    ((4, 19), 0.2),
    ((4, 20), 0.0),
    ((4, 21), 0.25),
    ((4, 22), 0.0),
    ((4, 23), 0.0),
    ((4, 24), 0.0),
    ((4, 25), 0.0),
    ((4, 26), 0.0),
    ((4, 27), 0.0),
    ((4, 28), 0.0),
    ((4, 29), 0.0),
    ((4, 30), 0.0),
    ((4, 31), 0.125),
    ((4, 32), 0.0),
    ((4, 33), 0.0),
    ((5, 7), 0.14285714285714285),
    ((5, 8), 0.125),
    ((5, 9), 0.0),
    ((5, 11), 0.25),
    ((5, 12), 0.2),
    ((5, 13), 0.125),
    ((5, 14), 0.0),
    ((5, 15), 0.0),
    ((5, 17), 0.2),
    ((5, 18), 0.0),
    ((5, 19), 0.16666666666666666),
    ((5, 20), 0.0),
    ((5, 21), 0.2),
    ((5, 22), 0.0),
    ((5, 23), 0.0),
    ((5, 24), 0.0),
    ((5, 25), 0.0),
    ((5, 26), 0.0),
    ((5, 27), 0.0),
    ((5, 28), 0.0),
    ((5, 29), 0.0),
    ((5, 30), 0.0),
    ((5, 31), 0.1111111111111111),
    ((5, 32), 0.0),
    ((5, 33), 0.0),
    ((6, 7), 0.14285714285714285),
    ((6, 8), 0.125),
    ((6, 9), 0.0),
    ((6, 10), 0.75),
    ((6, 11), 0.25),
    ((6, 12), 0.2),
    ((6, 13), 0.125),
    ((6, 14), 0.0),
    ((6, 15), 0.0),
    ((6, 17), 0.2),
    ((6, 18), 0.0),
    ((6, 19), 0.16666666666666666),
    ((6, 20), 0.0),
    ((6, 21), 0.2),
    ((6, 22), 0.0),
    ((6, 23), 0.0),
    ((6, 24), 0.0),
    ((6, 25), 0.0),
    ((6, 26), 0.0),
    ((6, 27), 0.0),
    ((6, 28), 0.0),
    ((6, 29), 0.0),
    ((6, 30), 0.0),
    ((6, 31), 0.1111111111111111),
    ((6, 32), 0.0),
    ((6, 33), 0.0),
    ((7, 8), 0.2857142857142857),
    ((7, 9), 0.2),
    ((7, 10), 0.16666666666666666),
    ((7, 11), 0.25),
    ((7, 12), 0.5),
    ((7, 13), 0.8),
    ((7, 14), 0.0),
    ((7, 15), 0.0),
    ((7, 16), 0.0),
    ((7, 17), 0.5),
    ((7, 18), 0.0),
    ((7, 19), 0.4),
    ((7, 20), 0.0),
    ((7, 21), 0.5),
    ((7, 22), 0.0),
    ((7, 23), 0.0),
    ((7, 24), 0.0),
    ((7, 25), 0.0),
    ((7, 26), 0.0),
    ((7, 27), 0.14285714285714285),
    ((7, 28), 0.16666666666666666),
    ((7, 29), 0.0),
    ((7, 30), 0.14285714285714285),
    ((7, 31), 0.1111111111111111),
    ((7, 32), 0.06666666666666667),
    ((7, 33), 0.0),
    ((8, 9), 0.4),
    ((8, 10), 0.14285714285714285),
    ((8, 11), 0.2),
    ((8, 12), 0.16666666666666666),
    ((8, 13), 0.42857142857142855),
    ((8, 14), 0.4),
    ((8, 15), 0.4),
    ((8, 16), 0.0),
    ((8, 17), 0.16666666666666666),
    ((8, 18), 0.4),
    ((8, 19), 0.3333333333333333),
    ((8, 20), 0.4),
    ((8, 21), 0.16666666666666666),
    ((8, 22), 0.4),
    ((8, 23), 0.25),
    ((8, 24), 0.0),
    ((8, 25), 0.0),
    ((8, 26), 0.16666666666666666),
    ((8, 27), 0.2857142857142857),
    ((8, 28), 0.3333333333333333),
    ((8, 29), 0.2857142857142857),
    ((8, 31), 0.375),
    ((9, 10), 0.0),
    ((9, 11), 0.0),
    ((9, 12), 0.0),
    ((9, 13), 0.4),
    ((9, 14), 0.3333333333333333),
    ((9, 15), 0.3333333333333333),
    ((9, 16), 0.0),
    ((9, 17), 0.0),
    ((9, 18), 0.3333333333333333),
    ((9, 19), 0.25),
    ((9, 20), 0.3333333333333333),
    ((9, 21), 0.0),
    ((9, 22), 0.3333333333333333),
    ((9, 23), 0.16666666666666666),
    ((9, 24), 0.0),
    ((9, 25), 0.0),
    ((9, 26), 0.3333333333333333),
    ((9, 27), 0.5),
    ((9, 28), 0.6666666666666666),
    ((9, 29), 0.2),
    ((9, 30), 0.2),
    ((9, 31), 0.14285714285714285),
    ((9, 32), 0.16666666666666666),
    ((10, 11), 0.3333333333333333),
    ((10, 12), 0.25),
    ((10, 13), 0.14285714285714285),
    ((10, 14), 0.0),
    ((10, 15), 0.0),
    ((10, 16), 0.25),
    ((10, 17), 0.25),
    ((10, 18), 0.0),
    ((10, 19), 0.2),
    ((10, 20), 0.0),
    ((10, 21), 0.25),
    ((10, 22), 0.0),
    ((10, 23), 0.0),
    ((10, 24), 0.0),
    ((10, 25), 0.0),
    ((10, 26), 0.0),
    ((10, 27), 0.0),
    ((10, 28), 0.0),
    ((10, 29), 0.0),
    ((10, 30), 0.0),
    ((10, 31), 0.125),
    ((10, 32), 0.0),
    ((10, 33), 0.0),
    ((11, 12), 0.5),
    ((11, 13), 0.2),
    ((11, 14), 0.0),
    ((11, 15), 0.0),
    ((11, 16), 0.0),
    ((11, 17), 0.5),
    ((11, 18), 0.0),
    ((11, 19), 0.3333333333333333),
    ((11, 20), 0.0),
    ((11, 21), 0.5),
    ((11, 22), 0.0),
    ((11, 23), 0.0),
    ((11, 24), 0.0),
    ((11, 25), 0.0),
    ((11, 26), 0.0),
    ((11, 27), 0.0),
    ((11, 28), 0.0),
    ((11, 29), 0.0),
    ((11, 30), 0.0),
    ((11, 31), 0.16666666666666666),
    ((11, 32), 0.0),
    ((11, 33), 0.0),
    ((12, 13), 0.4),
    ((12, 14), 0.0),
    ((12, 15), 0.0),
    ((12, 16), 0.0),
    ((12, 17), 0.3333333333333333),
    ((12, 18), 0.0),
    ((12, 19), 0.25),
    ((12, 20), 0.0),
    ((12, 21), 0.3333333333333333),
    ((12, 22), 0.0),
    ((12, 23), 0.0),
    ((12, 24), 0.0),
    ((12, 25), 0.0),
    ((12, 26), 0.0),
    ((12, 27), 0.0),
    ((12, 28), 0.0),
    ((12, 29), 0.0),
    ((12, 30), 0.0),
    ((12, 31), 0.14285714285714285),
    ((12, 32), 0.0),
    ((12, 33), 0.0),
    ((13, 14), 0.16666666666666666),
    ((13, 15), 0.16666666666666666),
    ((13, 16), 0.0),
    ((13, 17), 0.4),
    ((13, 18), 0.16666666666666666),
    ((13, 19), 0.6),
    ((13, 20), 0.16666666666666666),
    ((13, 21), 0.4),
    ((13, 22), 0.16666666666666666),
    ((13, 23), 0.1111111111111111),
    ((13, 24), 0.0),
    ((13, 25), 0.0),
    ((13, 26), 0.16666666666666666),
    ((13, 27), 0.2857142857142857),
    ((13, 28), 0.3333333333333333),
    ((13, 29), 0.125),
    ((13, 30), 0.2857142857142857),
    ((13, 31), 0.2222222222222222),
    ((13, 32), 0.13333333333333333),
    ((14, 15), 1.0),
    ((14, 16), 0.0),
    ((14, 17), 0.0),
    ((14, 18), 1.0),
    ((14, 19), 0.25),
    ((14, 20), 1.0),
    ((14, 21), 0.0),
    ((14, 22), 1.0),
    ((14, 23), 0.4),
    ((14, 24), 0.0),
    ((14, 25), 0.0),
    ((14, 26), 0.3333333333333333),
    ((14, 27), 0.2),
    ((14, 28), 0.25),
    ((14, 29), 0.5),
    ((14, 30), 0.5),
    ((14, 31), 0.3333333333333333),
    ((15, 16), 0.0),
    ((15, 17), 0.0),
    ((15, 18), 1.0),
    ((15, 19), 0.25),
    ((15, 20), 1.0),
    ((15, 21), 0.0),
    ((15, 22), 1.0),
    ((15, 23), 0.4),
    ((15, 24), 0.0),
    ((15, 25), 0.0),
    ((15, 26), 0.3333333333333333),
    ((15, 27), 0.2),
    ((15, 28), 0.25),
    ((15, 29), 0.5),
    ((15, 30), 0.5),
    ((15, 31), 0.3333333333333333),
    ((16, 17), 0.0),
    ((16, 18), 0.0),
    ((16, 19), 0.0),
    ((16, 20), 0.0),
    ((16, 21), 0.0),
    ((16, 22), 0.0),
    ((16, 23), 0.0),
    ((16, 24), 0.0),
    ((16, 25), 0.0),
    ((16, 26), 0.0),
    ((16, 27), 0.0),
    ((16, 28), 0.0),
    ((16, 29), 0.0),
    ((16, 30), 0.0),
    ((16, 31), 0.0),
    ((16, 32), 0.0),
    ((16, 33), 0.0),
    ((17, 18), 0.0),
    ((17, 19), 0.6666666666666666),
    ((17, 20), 0.0),
    ((17, 21), 1.0),
    ((17, 22), 0.0),
    ((17, 23), 0.0),
    ((17, 24), 0.0),
    ((17, 25), 0.0),
    ((17, 26), 0.0),
    ((17, 27), 0.0),
    ((17, 28), 0.0),
    ((17, 29), 0.0),
    ((17, 30), 0.2),
    ((17, 31), 0.14285714285714285),
    ((17, 32), 0.0),
    ((17, 33), 0.0),
    ((18, 19), 0.25),
    ((18, 20), 1.0),
    ((18, 21), 0.0),
    ((18, 22), 1.0),
    ((18, 23), 0.4),
    ((18, 24), 0.0),
    ((18, 25), 0.0),
    ((18, 26), 0.3333333333333333),
    ((18, 27), 0.2),
    ((18, 28), 0.25),
    ((18, 29), 0.5),
    ((18, 30), 0.5),
    ((18, 31), 0.3333333333333333),
    ((19, 20), 0.25),
    ((19, 21), 0.6666666666666666),
    ((19, 22), 0.25),
    ((19, 23), 0.14285714285714285),
    ((19, 24), 0.0),
    ((19, 25), 0.0),
    ((19, 26), 0.25),
    ((19, 27), 0.16666666666666666),
    ((19, 28), 0.2),
    ((19, 29), 0.16666666666666666),
    ((19, 30), 0.4),
    ((19, 31), 0.2857142857142857),
    ((19, 32), 0.07142857142857142),
    ((20, 21), 0.0),
    ((20, 22), 1.0),
    ((20, 23), 0.4),
    ((20, 24), 0.0),
    ((20, 25), 0.0),
    ((20, 26), 0.3333333333333333),
    ((20, 27), 0.2),
    ((20, 28), 0.25),
    ((20, 29), 0.5),
    ((20, 30), 0.5),
    ((20, 31), 0.3333333333333333),
    ((21, 22), 0.0),
    ((21, 23), 0.0),
    ((21, 24), 0.0),
    ((21, 25), 0.0),
    ((21, 26), 0.0),
    ((21, 27), 0.0),
    ((21, 28), 0.0),
    ((21, 29), 0.0),
    ((21, 30), 0.2),
    ((21, 31), 0.14285714285714285),
    ((21, 32), 0.0),
    ((21, 33), 0.0),
    ((22, 23), 0.4),
    ((22, 24), 0.0),
    ((22, 25), 0.0),
    ((22, 26), 0.3333333333333333),
    ((22, 27), 0.2),
    ((22, 28), 0.25),
    ((22, 29), 0.5),
    ((22, 30), 0.5),
    ((22, 31), 0.3333333333333333),
    ((23, 24), 0.3333333333333333),
    ((23, 26), 0.4),
    ((23, 28), 0.14285714285714285),
    ((23, 30), 0.2857142857142857),
    ((23, 31), 0.375),
    ((24, 26), 0.0),
    ((24, 28), 0.2),
    ((24, 29), 0.0),
    ((24, 30), 0.0),
    ((24, 32), 0.07142857142857142),
    ((24, 33), 0.1111111111111111),
    ((25, 26), 0.0),
    ((25, 27), 0.4),
    ((25, 28), 0.2),
    ((25, 29), 0.16666666666666666),
    ((25, 30), 0.0),
    ((25, 32), 0.15384615384615385),
    ((25, 33), 0.1111111111111111),
    ((26, 27), 0.2),
    ((26, 28), 0.25),
    ((26, 30), 0.2),
    ((26, 31), 0.14285714285714285),
    ((26, 32), 0.16666666666666666),
    ((27, 28), 0.4),
    ((27, 29), 0.3333333333333333),
    ((27, 30), 0.14285714285714285),
    ((27, 31), 0.25),
    ((27, 32), 0.23076923076923078),
    ((28, 29), 0.16666666666666666),
    ((28, 30), 0.16666666666666666),
    ((28, 32), 0.25),
    ((29, 30), 0.3333333333333333),
    ((29, 31), 0.25),
    ((30, 31), 0.25)
  ]
  for i in 0..<len(got):
    check (got[i].edge == expected[i].edge and equal(got[i].prediction, expected[i].prediction)) == true

test "adamic adar index":
  let karate = karateClubGraph()
  let got = adamicAdarIndex(karate)
  let expected: seq[tuple[edge: Edge, prediction: float]] = @[
    ((0, 9), 0.43429448190325176),
    ((0, 14), 0.0),
    ((0, 15), 0.0),
    ((0, 16), 1.4426950408889634),
    ((0, 18), 0.0),
    ((0, 20), 0.0),
    ((0, 22), 0.0),
    ((0, 23), 0.0),
    ((0, 24), 0.5581106265512472),
    ((0, 25), 0.5581106265512472),
    ((0, 26), 0.0),
    ((0, 27), 0.43429448190325176),
    ((0, 28), 0.9924051084544989),
    ((0, 29), 0.0),
    ((0, 30), 1.0764545478730305),
    ((0, 32), 1.613740043014111),
    ((0, 33), 2.7110197222973085),
    ((1, 4), 0.36067376022224085),
    ((1, 5), 0.36067376022224085),
    ((1, 6), 0.36067376022224085),
    ((1, 8), 1.5163157625699744),
    ((1, 9), 0.43429448190325176),
    ((1, 10), 0.36067376022224085),
    ((1, 11), 0.36067376022224085),
    ((1, 12), 0.9187843867734881),
    ((1, 14), 0.0),
    ((1, 15), 0.0),
    ((1, 16), 0.0),
    ((1, 18), 0.0),
    ((1, 20), 0.0),
    ((1, 22), 0.0),
    ((1, 23), 0.0),
    ((1, 24), 0.0),
    ((1, 25), 0.0),
    ((1, 26), 0.0),
    ((1, 27), 0.43429448190325176),
    ((1, 28), 0.43429448190325176),
    ((1, 29), 0.0),
    ((1, 31), 0.36067376022224085),
    ((1, 32), 1.1556420023477334),
    ((1, 33), 2.252921681630931),
    ((2, 4), 0.36067376022224085),
    ((2, 5), 0.36067376022224085),
    ((2, 6), 0.36067376022224085),
    ((2, 10), 0.36067376022224085),
    ((2, 11), 0.36067376022224085),
    ((2, 12), 0.9187843867734881),
    ((2, 14), 0.40242960438184466),
    ((2, 15), 0.40242960438184466),
    ((2, 16), 0.0),
    ((2, 17), 0.8157933735356595),
    ((2, 18), 0.40242960438184466),
    ((2, 19), 0.8157933735356595),
    ((2, 20), 0.40242960438184466),
    ((2, 21), 0.8157933735356595),
    ((2, 22), 0.40242960438184466),
    ((2, 23), 1.1237771248263264),
    ((2, 24), 0.7213475204444817),
    ((2, 25), 0.0),
    ((2, 26), 0.0),
    ((2, 29), 0.40242960438184466),
    ((2, 30), 1.4788841522548752),
    ((2, 31), 1.6733425912309228),
    ((2, 33), 4.719381261461351),
    ((3, 4), 0.36067376022224085),
    ((3, 5), 0.36067376022224085),
    ((3, 6), 0.36067376022224085),
    ((3, 8), 0.7949682421254927),
    ((3, 9), 0.43429448190325176),
    ((3, 10), 0.36067376022224085),
    ((3, 11), 0.36067376022224085),
    ((3, 14), 0.0),
    ((3, 15), 0.0),
    ((3, 16), 0.0),
    ((3, 17), 0.8157933735356595),
    ((3, 18), 0.0),
    ((3, 19), 0.8157933735356595),
    ((3, 20), 0.0),
    ((3, 21), 0.8157933735356595),
    ((3, 22), 0.0),
    ((3, 23), 0.0),
    ((3, 24), 0.0),
    ((3, 25), 0.0),
    ((3, 26), 0.0),
    ((3, 27), 0.43429448190325176),
    ((3, 28), 0.43429448190325176),
    ((3, 29), 0.0),
    ((3, 30), 0.45511961331341866),
    ((3, 31), 0.36067376022224085),
    ((3, 32), 0.43429448190325176),
    ((3, 33), 0.6213349345596119),
    ((4, 5), 1.9922605072935597),
    ((4, 7), 0.36067376022224085),
    ((4, 8), 0.36067376022224085),
    ((4, 9), 0.0),
    ((4, 11), 0.36067376022224085),
    ((4, 12), 0.36067376022224085),
    ((4, 13), 0.36067376022224085),
    ((4, 14), 0.0),
    ((4, 15), 0.0),
    ((4, 16), 0.7213475204444817),
    ((4, 17), 0.36067376022224085),
    ((4, 18), 0.0),
    ((4, 19), 0.36067376022224085),
    ((4, 20), 0.0),
    ((4, 21), 0.36067376022224085),
    ((4, 22), 0.0),
    ((4, 23), 0.0),
    ((4, 24), 0.0),
    ((4, 25), 0.0),
    ((4, 26), 0.0),
    ((4, 27), 0.0),
    ((4, 28), 0.0),
    ((4, 29), 0.0),
    ((4, 30), 0.0),
    ((4, 31), 0.36067376022224085),
    ((4, 32), 0.0),
    ((4, 33), 0.0),
    ((5, 7), 0.36067376022224085),
    ((5, 8), 0.36067376022224085),
    ((5, 9), 0.0),
    ((5, 11), 0.36067376022224085),
    ((5, 12), 0.36067376022224085),
    ((5, 13), 0.36067376022224085),
    ((5, 14), 0.0),
    ((5, 15), 0.0),
    ((5, 17), 0.36067376022224085),
    ((5, 18), 0.0),
    ((5, 19), 0.36067376022224085),
    ((5, 20), 0.0),
    ((5, 21), 0.36067376022224085),
    ((5, 22), 0.0),
    ((5, 23), 0.0),
    ((5, 24), 0.0),
    ((5, 25), 0.0),
    ((5, 26), 0.0),
    ((5, 27), 0.0),
    ((5, 28), 0.0),
    ((5, 29), 0.0),
    ((5, 30), 0.0),
    ((5, 31), 0.36067376022224085),
    ((5, 32), 0.0),
    ((5, 33), 0.0),
    ((6, 7), 0.36067376022224085),
    ((6, 8), 0.36067376022224085),
    ((6, 9), 0.0),
    ((6, 10), 1.9922605072935597),
    ((6, 11), 0.36067376022224085),
    ((6, 12), 0.36067376022224085),
    ((6, 13), 0.36067376022224085),
    ((6, 14), 0.0),
    ((6, 15), 0.0),
    ((6, 17), 0.36067376022224085),
    ((6, 18), 0.0),
    ((6, 19), 0.36067376022224085),
    ((6, 20), 0.0),
    ((6, 21), 0.36067376022224085),
    ((6, 22), 0.0),
    ((6, 23), 0.0),
    ((6, 24), 0.0),
    ((6, 25), 0.0),
    ((6, 26), 0.0),
    ((6, 27), 0.0),
    ((6, 28), 0.0),
    ((6, 29), 0.0),
    ((6, 30), 0.0),
    ((6, 31), 0.36067376022224085),
    ((6, 32), 0.0),
    ((6, 33), 0.0),
    ((7, 8), 0.7949682421254927),
    ((7, 9), 0.43429448190325176),
    ((7, 10), 0.36067376022224085),
    ((7, 11), 0.36067376022224085),
    ((7, 12), 0.9187843867734881),
    ((7, 13), 1.8081984819901584),
    ((7, 14), 0.0),
    ((7, 15), 0.0),
    ((7, 16), 0.0),
    ((7, 17), 0.8157933735356595),
    ((7, 18), 0.0),
    ((7, 19), 0.8157933735356595),
    ((7, 20), 0.0),
    ((7, 21), 0.8157933735356595),
    ((7, 22), 0.0),
    ((7, 23), 0.0),
    ((7, 24), 0.0),
    ((7, 25), 0.0),
    ((7, 26), 0.0),
    ((7, 27), 0.43429448190325176),
    ((7, 28), 0.43429448190325176),
    ((7, 29), 0.0),
    ((7, 30), 0.45511961331341866),
    ((7, 31), 0.36067376022224085),
    ((7, 32), 0.43429448190325176),
    ((7, 33), 0.0),
    ((8, 9), 0.7872506057680129),
    ((8, 10), 0.36067376022224085),
    ((8, 11), 0.36067376022224085),
    ((8, 12), 0.36067376022224085),
    ((8, 13), 1.1479243659902538),
    ((8, 14), 0.7553857282466059),
    ((8, 15), 0.7553857282466059),
    ((8, 16), 0.0),
    ((8, 17), 0.36067376022224085),
    ((8, 18), 0.7553857282466059),
    ((8, 19), 0.713629884087002),
    ((8, 20), 0.7553857282466059),
    ((8, 21), 0.36067376022224085),
    ((8, 22), 0.7553857282466059),
    ((8, 23), 0.7553857282466059),
    ((8, 24), 0.0),
    ((8, 25), 0.0),
    ((8, 26), 0.35295612386476116),
    ((8, 27), 0.7872506057680129),
    ((8, 28), 0.7872506057680129),
    ((8, 29), 0.7553857282466059),
    ((8, 31), 1.1160594884688466),
    ((9, 10), 0.0),
    ((9, 11), 0.0),
    ((9, 12), 0.0),
    ((9, 13), 0.7872506057680129),
    ((9, 14), 0.35295612386476116),
    ((9, 15), 0.35295612386476116),
    ((9, 16), 0.0),
    ((9, 17), 0.0),
    ((9, 18), 0.35295612386476116),
    ((9, 19), 0.35295612386476116),
    ((9, 20), 0.35295612386476116),
    ((9, 21), 0.0),
    ((9, 22), 0.35295612386476116),
    ((9, 23), 0.35295612386476116),
    ((9, 24), 0.0),
    ((9, 25), 0.0),
    ((9, 26), 0.35295612386476116),
    ((9, 27), 0.7872506057680129),
    ((9, 28), 0.7872506057680129),
    ((9, 29), 0.35295612386476116),
    ((9, 30), 0.35295612386476116),
    ((9, 31), 0.35295612386476116),
    ((9, 32), 0.7872506057680129),
    ((10, 11), 0.36067376022224085),
    ((10, 12), 0.36067376022224085),
    ((10, 13), 0.36067376022224085),
    ((10, 14), 0.0),
    ((10, 15), 0.0),
    ((10, 16), 0.7213475204444817),
    ((10, 17), 0.36067376022224085),
    ((10, 18), 0.0),
    ((10, 19), 0.36067376022224085),
    ((10, 20), 0.0),
    ((10, 21), 0.36067376022224085),
    ((10, 22), 0.0),
    ((10, 23), 0.0),
    ((10, 24), 0.0),
    ((10, 25), 0.0),
    ((10, 26), 0.0),
    ((10, 27), 0.0),
    ((10, 28), 0.0),
    ((10, 29), 0.0),
    ((10, 30), 0.0),
    ((10, 31), 0.36067376022224085),
    ((10, 32), 0.0),
    ((10, 33), 0.0),
    ((11, 12), 0.36067376022224085),
    ((11, 13), 0.36067376022224085),
    ((11, 14), 0.0),
    ((11, 15), 0.0),
    ((11, 16), 0.0),
    ((11, 17), 0.36067376022224085),
    ((11, 18), 0.0),
    ((11, 19), 0.36067376022224085),
    ((11, 20), 0.0),
    ((11, 21), 0.36067376022224085),
    ((11, 22), 0.0),
    ((11, 23), 0.0),
    ((11, 24), 0.0),
    ((11, 25), 0.0),
    ((11, 26), 0.0),
    ((11, 27), 0.0),
    ((11, 28), 0.0),
    ((11, 29), 0.0),
    ((11, 30), 0.0),
    ((11, 31), 0.36067376022224085),
    ((11, 32), 0.0),
    ((11, 33), 0.0),
    ((12, 13), 0.9187843867734881),
    ((12, 14), 0.0),
    ((12, 15), 0.0),
    ((12, 16), 0.0),
    ((12, 17), 0.36067376022224085),
    ((12, 18), 0.0),
    ((12, 19), 0.36067376022224085),
    ((12, 20), 0.0),
    ((12, 21), 0.36067376022224085),
    ((12, 22), 0.0),
    ((12, 23), 0.0),
    ((12, 24), 0.0),
    ((12, 25), 0.0),
    ((12, 26), 0.0),
    ((12, 27), 0.0),
    ((12, 28), 0.0),
    ((12, 29), 0.0),
    ((12, 30), 0.0),
    ((12, 31), 0.36067376022224085),
    ((12, 32), 0.0),
    ((12, 33), 0.0),
    ((13, 14), 0.35295612386476116),
    ((13, 15), 0.35295612386476116),
    ((13, 16), 0.0),
    ((13, 17), 0.8157933735356595),
    ((13, 18), 0.35295612386476116),
    ((13, 19), 1.1687494974004207),
    ((13, 20), 0.35295612386476116),
    ((13, 21), 0.8157933735356595),
    ((13, 22), 0.35295612386476116),
    ((13, 23), 0.35295612386476116),
    ((13, 24), 0.0),
    ((13, 25), 0.0),
    ((13, 26), 0.35295612386476116),
    ((13, 27), 0.7872506057680129),
    ((13, 28), 0.7872506057680129),
    ((13, 29), 0.35295612386476116),
    ((13, 30), 0.8080757371781798),
    ((13, 31), 0.713629884087002),
    ((13, 32), 0.7872506057680129),
    ((14, 15), 0.7553857282466059),
    ((14, 16), 0.0),
    ((14, 17), 0.0),
    ((14, 18), 0.7553857282466059),
    ((14, 19), 0.35295612386476116),
    ((14, 20), 0.7553857282466059),
    ((14, 21), 0.0),
    ((14, 22), 0.7553857282466059),
    ((14, 23), 0.7553857282466059),
    ((14, 24), 0.0),
    ((14, 25), 0.0),
    ((14, 26), 0.35295612386476116),
    ((14, 27), 0.35295612386476116),
    ((14, 28), 0.35295612386476116),
    ((14, 29), 0.7553857282466059),
    ((14, 30), 0.7553857282466059),
    ((14, 31), 0.7553857282466059),
    ((15, 16), 0.0),
    ((15, 17), 0.0),
    ((15, 18), 0.7553857282466059),
    ((15, 19), 0.35295612386476116),
    ((15, 20), 0.7553857282466059),
    ((15, 21), 0.0),
    ((15, 22), 0.7553857282466059),
    ((15, 23), 0.7553857282466059),
    ((15, 24), 0.0),
    ((15, 25), 0.0),
    ((15, 26), 0.35295612386476116),
    ((15, 27), 0.35295612386476116),
    ((15, 28), 0.35295612386476116),
    ((15, 29), 0.7553857282466059),
    ((15, 30), 0.7553857282466059),
    ((15, 31), 0.7553857282466059),
    ((16, 17), 0.0),
    ((16, 18), 0.0),
    ((16, 19), 0.0),
    ((16, 20), 0.0),
    ((16, 21), 0.0),
    ((16, 22), 0.0),
    ((16, 23), 0.0),
    ((16, 24), 0.0),
    ((16, 25), 0.0),
    ((16, 26), 0.0),
    ((16, 27), 0.0),
    ((16, 28), 0.0),
    ((16, 29), 0.0),
    ((16, 30), 0.0),
    ((16, 31), 0.0),
    ((16, 32), 0.0),
    ((16, 33), 0.0),
    ((17, 18), 0.0),
    ((17, 19), 0.8157933735356595),
    ((17, 20), 0.0),
    ((17, 21), 0.8157933735356595),
    ((17, 22), 0.0),
    ((17, 23), 0.0),
    ((17, 24), 0.0),
    ((17, 25), 0.0),
    ((17, 26), 0.0),
    ((17, 27), 0.0),
    ((17, 28), 0.0),
    ((17, 29), 0.0),
    ((17, 30), 0.45511961331341866),
    ((17, 31), 0.36067376022224085),
    ((17, 32), 0.0),
    ((17, 33), 0.0),
    ((18, 19), 0.35295612386476116),
    ((18, 20), 0.7553857282466059),
    ((18, 21), 0.0),
    ((18, 22), 0.7553857282466059),
    ((18, 23), 0.7553857282466059),
    ((18, 24), 0.0),
    ((18, 25), 0.0),
    ((18, 26), 0.35295612386476116),
    ((18, 27), 0.35295612386476116),
    ((18, 28), 0.35295612386476116),
    ((18, 29), 0.7553857282466059),
    ((18, 30), 0.7553857282466059),
    ((18, 31), 0.7553857282466059),
    ((19, 20), 0.35295612386476116),
    ((19, 21), 0.8157933735356595),
    ((19, 22), 0.35295612386476116),
    ((19, 23), 0.35295612386476116),
    ((19, 24), 0.0),
    ((19, 25), 0.0),
    ((19, 26), 0.35295612386476116),
    ((19, 27), 0.35295612386476116),
    ((19, 28), 0.35295612386476116),
    ((19, 29), 0.35295612386476116),
    ((19, 30), 0.8080757371781798),
    ((19, 31), 0.713629884087002),
    ((19, 32), 0.35295612386476116),
    ((20, 21), 0.0),
    ((20, 22), 0.7553857282466059),
    ((20, 23), 0.7553857282466059),
    ((20, 24), 0.0),
    ((20, 25), 0.0),
    ((20, 26), 0.35295612386476116),
    ((20, 27), 0.35295612386476116),
    ((20, 28), 0.35295612386476116),
    ((20, 29), 0.7553857282466059),
    ((20, 30), 0.7553857282466059),
    ((20, 31), 0.7553857282466059),
    ((21, 22), 0.0),
    ((21, 23), 0.0),
    ((21, 24), 0.0),
    ((21, 25), 0.0),
    ((21, 26), 0.0),
    ((21, 27), 0.0),
    ((21, 28), 0.0),
    ((21, 29), 0.0),
    ((21, 30), 0.45511961331341866),
    ((21, 31), 0.36067376022224085),
    ((21, 32), 0.0),
    ((21, 33), 0.0),
    ((22, 23), 0.7553857282466059),
    ((22, 24), 0.0),
    ((22, 25), 0.0),
    ((22, 26), 0.35295612386476116),
    ((22, 27), 0.35295612386476116),
    ((22, 28), 0.35295612386476116),
    ((22, 29), 0.7553857282466059),
    ((22, 30), 0.7553857282466059),
    ((22, 31), 0.7553857282466059),
    ((23, 24), 1.631586747071319),
    ((23, 26), 1.0743036443092429),
    ((23, 28), 0.35295612386476116),
    ((23, 30), 0.7553857282466059),
    ((23, 31), 1.6656249548734432),
    ((24, 26), 0.0),
    ((24, 28), 0.5581106265512472),
    ((24, 29), 0.0),
    ((24, 30), 0.0),
    ((24, 32), 0.5581106265512472),
    ((24, 33), 1.279458146995729),
    ((25, 26), 0.0),
    ((25, 27), 1.531574161186449),
    ((25, 28), 0.5581106265512472),
    ((25, 29), 0.6213349345596119),
    ((25, 30), 0.0),
    ((25, 32), 1.179445561110859),
    ((25, 33), 1.179445561110859),
    ((26, 27), 0.35295612386476116),
    ((26, 28), 0.35295612386476116),
    ((26, 30), 0.35295612386476116),
    ((26, 31), 0.35295612386476116),
    ((26, 32), 1.0743036443092429),
    ((27, 28), 0.7872506057680129),
    ((27, 29), 0.974291058424373),
    ((27, 30), 0.35295612386476116),
    ((27, 31), 1.2631953504915985),
    ((27, 32), 1.4085855403276248),
    ((28, 29), 0.35295612386476116),
    ((28, 30), 0.35295612386476116),
    ((28, 32), 1.34536123231926),
    ((29, 30), 0.7553857282466059),
    ((29, 31), 0.7553857282466059),
    ((30, 31), 0.7553857282466059),
  ]
  for i in 0..<len(got):
    check (got[i].edge == expected[i].edge and equal(got[i].prediction, expected[i].prediction)) == true

test "prefential attachment":
  let karate = karateClubGraph()
  let got = prefentialAttachment(karate)
  let expected: seq[tuple[edge: Edge, prediction: float]] = @[
    ((0, 9), 32.0),
    ((0, 14), 32.0),
    ((0, 15), 32.0),
    ((0, 16), 32.0),
    ((0, 18), 32.0),
    ((0, 20), 32.0),
    ((0, 22), 32.0),
    ((0, 23), 80.0),
    ((0, 24), 48.0),
    ((0, 25), 48.0),
    ((0, 26), 32.0),
    ((0, 27), 64.0),
    ((0, 28), 48.0),
    ((0, 29), 64.0),
    ((0, 30), 64.0),
    ((0, 32), 192.0),
    ((0, 33), 272.0),
    ((1, 4), 27.0),
    ((1, 5), 36.0),
    ((1, 6), 36.0),
    ((1, 8), 45.0),
    ((1, 9), 18.0),
    ((1, 10), 27.0),
    ((1, 11), 9.0),
    ((1, 12), 18.0),
    ((1, 14), 18.0),
    ((1, 15), 18.0),
    ((1, 16), 18.0),
    ((1, 18), 18.0),
    ((1, 20), 18.0),
    ((1, 22), 18.0),
    ((1, 23), 45.0),
    ((1, 24), 27.0),
    ((1, 25), 27.0),
    ((1, 26), 18.0),
    ((1, 27), 36.0),
    ((1, 28), 27.0),
    ((1, 29), 36.0),
    ((1, 31), 54.0),
    ((1, 32), 108.0),
    ((1, 33), 153.0),
    ((2, 4), 30.0),
    ((2, 5), 40.0),
    ((2, 6), 40.0),
    ((2, 10), 30.0),
    ((2, 11), 10.0),
    ((2, 12), 20.0),
    ((2, 14), 20.0),
    ((2, 15), 20.0),
    ((2, 16), 20.0),
    ((2, 17), 20.0),
    ((2, 18), 20.0),
    ((2, 19), 30.0),
    ((2, 20), 20.0),
    ((2, 21), 20.0),
    ((2, 22), 20.0),
    ((2, 23), 50.0),
    ((2, 24), 30.0),
    ((2, 25), 30.0),
    ((2, 26), 20.0),
    ((2, 29), 40.0),
    ((2, 30), 40.0),
    ((2, 31), 60.0),
    ((2, 33), 170.0),
    ((3, 4), 18.0),
    ((3, 5), 24.0),
    ((3, 6), 24.0),
    ((3, 8), 30.0),
    ((3, 9), 12.0),
    ((3, 10), 18.0),
    ((3, 11), 6.0),
    ((3, 14), 12.0),
    ((3, 15), 12.0),
    ((3, 16), 12.0),
    ((3, 17), 12.0),
    ((3, 18), 12.0),
    ((3, 19), 18.0),
    ((3, 20), 12.0),
    ((3, 21), 12.0),
    ((3, 22), 12.0),
    ((3, 23), 30.0),
    ((3, 24), 18.0),
    ((3, 25), 18.0),
    ((3, 26), 12.0),
    ((3, 27), 24.0),
    ((3, 28), 18.0),
    ((3, 29), 24.0),
    ((3, 30), 24.0),
    ((3, 31), 36.0),
    ((3, 32), 72.0),
    ((3, 33), 102.0),
    ((4, 5), 12.0),
    ((4, 7), 12.0),
    ((4, 8), 15.0),
    ((4, 9), 6.0),
    ((4, 11), 3.0),
    ((4, 12), 6.0),
    ((4, 13), 15.0),
    ((4, 14), 6.0),
    ((4, 15), 6.0),
    ((4, 16), 6.0),
    ((4, 17), 6.0),
    ((4, 18), 6.0),
    ((4, 19), 9.0),
    ((4, 20), 6.0),
    ((4, 21), 6.0),
    ((4, 22), 6.0),
    ((4, 23), 15.0),
    ((4, 24), 9.0),
    ((4, 25), 9.0),
    ((4, 26), 6.0),
    ((4, 27), 12.0),
    ((4, 28), 9.0),
    ((4, 29), 12.0),
    ((4, 30), 12.0),
    ((4, 31), 18.0),
    ((4, 32), 36.0),
    ((4, 33), 51.0),
    ((5, 7), 16.0),
    ((5, 8), 20.0),
    ((5, 9), 8.0),
    ((5, 11), 4.0),
    ((5, 12), 8.0),
    ((5, 13), 20.0),
    ((5, 14), 8.0),
    ((5, 15), 8.0),
    ((5, 17), 8.0),
    ((5, 18), 8.0),
    ((5, 19), 12.0),
    ((5, 20), 8.0),
    ((5, 21), 8.0),
    ((5, 22), 8.0),
    ((5, 23), 20.0),
    ((5, 24), 12.0),
    ((5, 25), 12.0),
    ((5, 26), 8.0),
    ((5, 27), 16.0),
    ((5, 28), 12.0),
    ((5, 29), 16.0),
    ((5, 30), 16.0),
    ((5, 31), 24.0),
    ((5, 32), 48.0),
    ((5, 33), 68.0),
    ((6, 7), 16.0),
    ((6, 8), 20.0),
    ((6, 9), 8.0),
    ((6, 10), 12.0),
    ((6, 11), 4.0),
    ((6, 12), 8.0),
    ((6, 13), 20.0),
    ((6, 14), 8.0),
    ((6, 15), 8.0),
    ((6, 17), 8.0),
    ((6, 18), 8.0),
    ((6, 19), 12.0),
    ((6, 20), 8.0),
    ((6, 21), 8.0),
    ((6, 22), 8.0),
    ((6, 23), 20.0),
    ((6, 24), 12.0),
    ((6, 25), 12.0),
    ((6, 26), 8.0),
    ((6, 27), 16.0),
    ((6, 28), 12.0),
    ((6, 29), 16.0),
    ((6, 30), 16.0),
    ((6, 31), 24.0),
    ((6, 32), 48.0),
    ((6, 33), 68.0),
    ((7, 8), 20.0),
    ((7, 9), 8.0),
    ((7, 10), 12.0),
    ((7, 11), 4.0),
    ((7, 12), 8.0),
    ((7, 13), 20.0),
    ((7, 14), 8.0),
    ((7, 15), 8.0),
    ((7, 16), 8.0),
    ((7, 17), 8.0),
    ((7, 18), 8.0),
    ((7, 19), 12.0),
    ((7, 20), 8.0),
    ((7, 21), 8.0),
    ((7, 22), 8.0),
    ((7, 23), 20.0),
    ((7, 24), 12.0),
    ((7, 25), 12.0),
    ((7, 26), 8.0),
    ((7, 27), 16.0),
    ((7, 28), 12.0),
    ((7, 29), 16.0),
    ((7, 30), 16.0),
    ((7, 31), 24.0),
    ((7, 32), 48.0),
    ((7, 33), 68.0),
    ((8, 9), 10.0),
    ((8, 10), 15.0),
    ((8, 11), 5.0),
    ((8, 12), 10.0),
    ((8, 13), 25.0),
    ((8, 14), 10.0),
    ((8, 15), 10.0),
    ((8, 16), 10.0),
    ((8, 17), 10.0),
    ((8, 18), 10.0),
    ((8, 19), 15.0),
    ((8, 20), 10.0),
    ((8, 21), 10.0),
    ((8, 22), 10.0),
    ((8, 23), 25.0),
    ((8, 24), 15.0),
    ((8, 25), 15.0),
    ((8, 26), 10.0),
    ((8, 27), 20.0),
    ((8, 28), 15.0),
    ((8, 29), 20.0),
    ((8, 31), 30.0),
    ((9, 10), 6.0),
    ((9, 11), 2.0),
    ((9, 12), 4.0),
    ((9, 13), 10.0),
    ((9, 14), 4.0),
    ((9, 15), 4.0),
    ((9, 16), 4.0),
    ((9, 17), 4.0),
    ((9, 18), 4.0),
    ((9, 19), 6.0),
    ((9, 20), 4.0),
    ((9, 21), 4.0),
    ((9, 22), 4.0),
    ((9, 23), 10.0),
    ((9, 24), 6.0),
    ((9, 25), 6.0),
    ((9, 26), 4.0),
    ((9, 27), 8.0),
    ((9, 28), 6.0),
    ((9, 29), 8.0),
    ((9, 30), 8.0),
    ((9, 31), 12.0),
    ((9, 32), 24.0),
    ((10, 11), 3.0),
    ((10, 12), 6.0),
    ((10, 13), 15.0),
    ((10, 14), 6.0),
    ((10, 15), 6.0),
    ((10, 16), 6.0),
    ((10, 17), 6.0),
    ((10, 18), 6.0),
    ((10, 19), 9.0),
    ((10, 20), 6.0),
    ((10, 21), 6.0),
    ((10, 22), 6.0),
    ((10, 23), 15.0),
    ((10, 24), 9.0),
    ((10, 25), 9.0),
    ((10, 26), 6.0),
    ((10, 27), 12.0),
    ((10, 28), 9.0),
    ((10, 29), 12.0),
    ((10, 30), 12.0),
    ((10, 31), 18.0),
    ((10, 32), 36.0),
    ((10, 33), 51.0),
    ((11, 12), 2.0),
    ((11, 13), 5.0),
    ((11, 14), 2.0),
    ((11, 15), 2.0),
    ((11, 16), 2.0),
    ((11, 17), 2.0),
    ((11, 18), 2.0),
    ((11, 19), 3.0),
    ((11, 20), 2.0),
    ((11, 21), 2.0),
    ((11, 22), 2.0),
    ((11, 23), 5.0),
    ((11, 24), 3.0),
    ((11, 25), 3.0),
    ((11, 26), 2.0),
    ((11, 27), 4.0),
    ((11, 28), 3.0),
    ((11, 29), 4.0),
    ((11, 30), 4.0),
    ((11, 31), 6.0),
    ((11, 32), 12.0),
    ((11, 33), 17.0),
    ((12, 13), 10.0),
    ((12, 14), 4.0),
    ((12, 15), 4.0),
    ((12, 16), 4.0),
    ((12, 17), 4.0),
    ((12, 18), 4.0),
    ((12, 19), 6.0),
    ((12, 20), 4.0),
    ((12, 21), 4.0),
    ((12, 22), 4.0),
    ((12, 23), 10.0),
    ((12, 24), 6.0),
    ((12, 25), 6.0),
    ((12, 26), 4.0),
    ((12, 27), 8.0),
    ((12, 28), 6.0),
    ((12, 29), 8.0),
    ((12, 30), 8.0),
    ((12, 31), 12.0),
    ((12, 32), 24.0),
    ((12, 33), 34.0),
    ((13, 14), 10.0),
    ((13, 15), 10.0),
    ((13, 16), 10.0),
    ((13, 17), 10.0),
    ((13, 18), 10.0),
    ((13, 19), 15.0),
    ((13, 20), 10.0),
    ((13, 21), 10.0),
    ((13, 22), 10.0),
    ((13, 23), 25.0),
    ((13, 24), 15.0),
    ((13, 25), 15.0),
    ((13, 26), 10.0),
    ((13, 27), 20.0),
    ((13, 28), 15.0),
    ((13, 29), 20.0),
    ((13, 30), 20.0),
    ((13, 31), 30.0),
    ((13, 32), 60.0),
    ((14, 15), 4.0),
    ((14, 16), 4.0),
    ((14, 17), 4.0),
    ((14, 18), 4.0),
    ((14, 19), 6.0),
    ((14, 20), 4.0),
    ((14, 21), 4.0),
    ((14, 22), 4.0),
    ((14, 23), 10.0),
    ((14, 24), 6.0),
    ((14, 25), 6.0),
    ((14, 26), 4.0),
    ((14, 27), 8.0),
    ((14, 28), 6.0),
    ((14, 29), 8.0),
    ((14, 30), 8.0),
    ((14, 31), 12.0),
    ((15, 16), 4.0),
    ((15, 17), 4.0),
    ((15, 18), 4.0),
    ((15, 19), 6.0),
    ((15, 20), 4.0),
    ((15, 21), 4.0),
    ((15, 22), 4.0),
    ((15, 23), 10.0),
    ((15, 24), 6.0),
    ((15, 25), 6.0),
    ((15, 26), 4.0),
    ((15, 27), 8.0),
    ((15, 28), 6.0),
    ((15, 29), 8.0),
    ((15, 30), 8.0),
    ((15, 31), 12.0),
    ((16, 17), 4.0),
    ((16, 18), 4.0),
    ((16, 19), 6.0),
    ((16, 20), 4.0),
    ((16, 21), 4.0),
    ((16, 22), 4.0),
    ((16, 23), 10.0),
    ((16, 24), 6.0),
    ((16, 25), 6.0),
    ((16, 26), 4.0),
    ((16, 27), 8.0),
    ((16, 28), 6.0),
    ((16, 29), 8.0),
    ((16, 30), 8.0),
    ((16, 31), 12.0),
    ((16, 32), 24.0),
    ((16, 33), 34.0),
    ((17, 18), 4.0),
    ((17, 19), 6.0),
    ((17, 20), 4.0),
    ((17, 21), 4.0),
    ((17, 22), 4.0),
    ((17, 23), 10.0),
    ((17, 24), 6.0),
    ((17, 25), 6.0),
    ((17, 26), 4.0),
    ((17, 27), 8.0),
    ((17, 28), 6.0),
    ((17, 29), 8.0),
    ((17, 30), 8.0),
    ((17, 31), 12.0),
    ((17, 32), 24.0),
    ((17, 33), 34.0),
    ((18, 19), 6.0),
    ((18, 20), 4.0),
    ((18, 21), 4.0),
    ((18, 22), 4.0),
    ((18, 23), 10.0),
    ((18, 24), 6.0),
    ((18, 25), 6.0),
    ((18, 26), 4.0),
    ((18, 27), 8.0),
    ((18, 28), 6.0),
    ((18, 29), 8.0),
    ((18, 30), 8.0),
    ((18, 31), 12.0),
    ((19, 20), 6.0),
    ((19, 21), 6.0),
    ((19, 22), 6.0),
    ((19, 23), 15.0),
    ((19, 24), 9.0),
    ((19, 25), 9.0),
    ((19, 26), 6.0),
    ((19, 27), 12.0),
    ((19, 28), 9.0),
    ((19, 29), 12.0),
    ((19, 30), 12.0),
    ((19, 31), 18.0),
    ((19, 32), 36.0),
    ((20, 21), 4.0),
    ((20, 22), 4.0),
    ((20, 23), 10.0),
    ((20, 24), 6.0),
    ((20, 25), 6.0),
    ((20, 26), 4.0),
    ((20, 27), 8.0),
    ((20, 28), 6.0),
    ((20, 29), 8.0),
    ((20, 30), 8.0),
    ((20, 31), 12.0),
    ((21, 22), 4.0),
    ((21, 23), 10.0),
    ((21, 24), 6.0),
    ((21, 25), 6.0),
    ((21, 26), 4.0),
    ((21, 27), 8.0),
    ((21, 28), 6.0),
    ((21, 29), 8.0),
    ((21, 30), 8.0),
    ((21, 31), 12.0),
    ((21, 32), 24.0),
    ((21, 33), 34.0),
    ((22, 23), 10.0),
    ((22, 24), 6.0),
    ((22, 25), 6.0),
    ((22, 26), 4.0),
    ((22, 27), 8.0),
    ((22, 28), 6.0),
    ((22, 29), 8.0),
    ((22, 30), 8.0),
    ((22, 31), 12.0),
    ((23, 24), 15.0),
    ((23, 26), 10.0),
    ((23, 28), 15.0),
    ((23, 30), 20.0),
    ((23, 31), 30.0),
    ((24, 26), 6.0),
    ((24, 28), 9.0),
    ((24, 29), 12.0),
    ((24, 30), 12.0),
    ((24, 32), 36.0),
    ((24, 33), 51.0),
    ((25, 26), 6.0),
    ((25, 27), 12.0),
    ((25, 28), 9.0),
    ((25, 29), 12.0),
    ((25, 30), 12.0),
    ((25, 32), 36.0),
    ((25, 33), 51.0),
    ((26, 27), 8.0),
    ((26, 28), 6.0),
    ((26, 30), 8.0),
    ((26, 31), 12.0),
    ((26, 32), 24.0),
    ((27, 28), 12.0),
    ((27, 29), 16.0),
    ((27, 30), 16.0),
    ((27, 31), 24.0),
    ((27, 32), 48.0),
    ((28, 29), 12.0),
    ((28, 30), 12.0),
    ((28, 32), 36.0),
    ((29, 30), 16.0),
    ((29, 31), 24.0),
    ((30, 31), 24.0),
  ]
  for i in 0..<len(got):
    check (got[i].edge == expected[i].edge and equal(got[i].prediction, expected[i].prediction)) == true

test "cn soundarajan hopcroft":
  let karate = karateClubGraph()
  let community = {
    0: 0, 1: 1, 2: 1, 3: 1, 4: 0, 5: 0, 6: 0, 7: 1, 8: 2, 9: 1,
    10: 0, 11: 0, 12: 1, 13: 1, 14: 2, 15: 2, 16: 0, 17: 1, 18: 2, 19: 0,
    20: 2, 21: 1, 22: 2, 23: 2, 24: 2, 25: 2, 26: 2, 27: 2, 28: 2, 29: 2,
    30: 2, 31: 2, 32: 2, 33: 2,
  }.toTable()
  let got = cnSoundarajanHopcroft(karate, community)
  let expected: seq[tuple[edge: Edge, prediction: float]] = @[
    ((0, 9), 1.0),
    ((0, 14), 0.0),
    ((0, 15), 0.0),
    ((0, 16), 4.0),
    ((0, 18), 0.0),
    ((0, 20), 0.0),
    ((0, 22), 0.0),
    ((0, 23), 0.0),
    ((0, 24), 1.0),
    ((0, 25), 1.0),
    ((0, 26), 0.0),
    ((0, 27), 1.0),
    ((0, 28), 2.0),
    ((0, 29), 0.0),
    ((0, 30), 2.0),
    ((0, 32), 3.0),
    ((0, 33), 4.0),
    ((1, 4), 1.0),
    ((1, 5), 1.0),
    ((1, 6), 1.0),
    ((1, 8), 3.0),
    ((1, 9), 2.0),
    ((1, 10), 1.0),
    ((1, 11), 1.0),
    ((1, 12), 3.0),
    ((1, 14), 0.0),
    ((1, 15), 0.0),
    ((1, 16), 0.0),
    ((1, 18), 0.0),
    ((1, 20), 0.0),
    ((1, 22), 0.0),
    ((1, 23), 0.0),
    ((1, 24), 0.0),
    ((1, 25), 0.0),
    ((1, 26), 0.0),
    ((1, 27), 1.0),
    ((1, 28), 1.0),
    ((1, 29), 0.0),
    ((1, 31), 1.0),
    ((1, 32), 2.0),
    ((1, 33), 3.0),
    ((2, 4), 1.0),
    ((2, 5), 1.0),
    ((2, 6), 1.0),
    ((2, 10), 1.0),
    ((2, 11), 1.0),
    ((2, 12), 3.0),
    ((2, 14), 1.0),
    ((2, 15), 1.0),
    ((2, 16), 0.0),
    ((2, 17), 3.0),
    ((2, 18), 1.0),
    ((2, 19), 2.0),
    ((2, 20), 1.0),
    ((2, 21), 3.0),
    ((2, 22), 1.0),
    ((2, 23), 2.0),
    ((2, 24), 1.0),
    ((2, 25), 0.0),
    ((2, 26), 0.0),
    ((2, 29), 1.0),
    ((2, 30), 3.0),
    ((2, 31), 3.0),
    ((2, 33), 6.0),
    ((3, 4), 1.0),
    ((3, 5), 1.0),
    ((3, 6), 1.0),
    ((3, 8), 2.0),
    ((3, 9), 2.0),
    ((3, 10), 1.0),
    ((3, 11), 1.0),
    ((3, 14), 0.0),
    ((3, 15), 0.0),
    ((3, 16), 0.0),
    ((3, 17), 3.0),
    ((3, 18), 0.0),
    ((3, 19), 2.0),
    ((3, 20), 0.0),
    ((3, 21), 3.0),
    ((3, 22), 0.0),
    ((3, 23), 0.0),
    ((3, 24), 0.0),
    ((3, 25), 0.0),
    ((3, 26), 0.0),
    ((3, 27), 1.0),
    ((3, 28), 1.0),
    ((3, 29), 0.0),
    ((3, 30), 1.0),
    ((3, 31), 1.0),
    ((3, 32), 1.0),
    ((3, 33), 1.0),
    ((4, 5), 6.0),
    ((4, 7), 1.0),
    ((4, 8), 1.0),
    ((4, 9), 0.0),
    ((4, 11), 2.0),
    ((4, 12), 1.0),
    ((4, 13), 1.0),
    ((4, 14), 0.0),
    ((4, 15), 0.0),
    ((4, 16), 2.0),
    ((4, 17), 1.0),
    ((4, 18), 0.0),
    ((4, 19), 2.0),
    ((4, 20), 0.0),
    ((4, 21), 1.0),
    ((4, 22), 0.0),
    ((4, 23), 0.0),
    ((4, 24), 0.0),
    ((4, 25), 0.0),
    ((4, 26), 0.0),
    ((4, 27), 0.0),
    ((4, 28), 0.0),
    ((4, 29), 0.0),
    ((4, 30), 0.0),
    ((4, 31), 1.0),
    ((4, 32), 0.0),
    ((4, 33), 0.0),
    ((5, 7), 1.0),
    ((5, 8), 1.0),
    ((5, 9), 0.0),
    ((5, 11), 2.0),
    ((5, 12), 1.0),
    ((5, 13), 1.0),
    ((5, 14), 0.0),
    ((5, 15), 0.0),
    ((5, 17), 1.0),
    ((5, 18), 0.0),
    ((5, 19), 2.0),
    ((5, 20), 0.0),
    ((5, 21), 1.0),
    ((5, 22), 0.0),
    ((5, 23), 0.0),
    ((5, 24), 0.0),
    ((5, 25), 0.0),
    ((5, 26), 0.0),
    ((5, 27), 0.0),
    ((5, 28), 0.0),
    ((5, 29), 0.0),
    ((5, 30), 0.0),
    ((5, 31), 1.0),
    ((5, 32), 0.0),
    ((5, 33), 0.0),
    ((6, 7), 1.0),
    ((6, 8), 1.0),
    ((6, 9), 0.0),
    ((6, 10), 6.0),
    ((6, 11), 2.0),
    ((6, 12), 1.0),
    ((6, 13), 1.0),
    ((6, 14), 0.0),
    ((6, 15), 0.0),
    ((6, 17), 1.0),
    ((6, 18), 0.0),
    ((6, 19), 2.0),
    ((6, 20), 0.0),
    ((6, 21), 1.0),
    ((6, 22), 0.0),
    ((6, 23), 0.0),
    ((6, 24), 0.0),
    ((6, 25), 0.0),
    ((6, 26), 0.0),
    ((6, 27), 0.0),
    ((6, 28), 0.0),
    ((6, 29), 0.0),
    ((6, 30), 0.0),
    ((6, 31), 1.0),
    ((6, 32), 0.0),
    ((6, 33), 0.0),
    ((7, 8), 2.0),
    ((7, 9), 2.0),
    ((7, 10), 1.0),
    ((7, 11), 1.0),
    ((7, 12), 3.0),
    ((7, 13), 7.0),
    ((7, 14), 0.0),
    ((7, 15), 0.0),
    ((7, 16), 0.0),
    ((7, 17), 3.0),
    ((7, 18), 0.0),
    ((7, 19), 2.0),
    ((7, 20), 0.0),
    ((7, 21), 3.0),
    ((7, 22), 0.0),
    ((7, 23), 0.0),
    ((7, 24), 0.0),
    ((7, 25), 0.0),
    ((7, 26), 0.0),
    ((7, 27), 1.0),
    ((7, 28), 1.0),
    ((7, 29), 0.0),
    ((7, 30), 1.0),
    ((7, 31), 1.0),
    ((7, 32), 1.0),
    ((7, 33), 0.0),
    ((8, 9), 2.0),
    ((8, 10), 1.0),
    ((8, 11), 1.0),
    ((8, 12), 1.0),
    ((8, 13), 3.0),
    ((8, 14), 4.0),
    ((8, 15), 4.0),
    ((8, 16), 0.0),
    ((8, 17), 1.0),
    ((8, 18), 4.0),
    ((8, 19), 2.0),
    ((8, 20), 4.0),
    ((8, 21), 1.0),
    ((8, 22), 4.0),
    ((8, 23), 4.0),
    ((8, 24), 0.0),
    ((8, 25), 0.0),
    ((8, 26), 2.0),
    ((8, 27), 3.0),
    ((8, 28), 3.0),
    ((8, 29), 4.0),
    ((8, 31), 5.0),
    ((9, 10), 0.0),
    ((9, 11), 0.0),
    ((9, 12), 0.0),
    ((9, 13), 3.0),
    ((9, 14), 1.0),
    ((9, 15), 1.0),
    ((9, 16), 0.0),
    ((9, 17), 0.0),
    ((9, 18), 1.0),
    ((9, 19), 1.0),
    ((9, 20), 1.0),
    ((9, 21), 0.0),
    ((9, 22), 1.0),
    ((9, 23), 1.0),
    ((9, 24), 0.0),
    ((9, 25), 0.0),
    ((9, 26), 1.0),
    ((9, 27), 2.0),
    ((9, 28), 2.0),
    ((9, 29), 1.0),
    ((9, 30), 1.0),
    ((9, 31), 1.0),
    ((9, 32), 2.0),
    ((10, 11), 2.0),
    ((10, 12), 1.0),
    ((10, 13), 1.0),
    ((10, 14), 0.0),
    ((10, 15), 0.0),
    ((10, 16), 2.0),
    ((10, 17), 1.0),
    ((10, 18), 0.0),
    ((10, 19), 2.0),
    ((10, 20), 0.0),
    ((10, 21), 1.0),
    ((10, 22), 0.0),
    ((10, 23), 0.0),
    ((10, 24), 0.0),
    ((10, 25), 0.0),
    ((10, 26), 0.0),
    ((10, 27), 0.0),
    ((10, 28), 0.0),
    ((10, 29), 0.0),
    ((10, 30), 0.0),
    ((10, 31), 1.0),
    ((10, 32), 0.0),
    ((10, 33), 0.0),
    ((11, 12), 1.0),
    ((11, 13), 1.0),
    ((11, 14), 0.0),
    ((11, 15), 0.0),
    ((11, 16), 0.0),
    ((11, 17), 1.0),
    ((11, 18), 0.0),
    ((11, 19), 2.0),
    ((11, 20), 0.0),
    ((11, 21), 1.0),
    ((11, 22), 0.0),
    ((11, 23), 0.0),
    ((11, 24), 0.0),
    ((11, 25), 0.0),
    ((11, 26), 0.0),
    ((11, 27), 0.0),
    ((11, 28), 0.0),
    ((11, 29), 0.0),
    ((11, 30), 0.0),
    ((11, 31), 1.0),
    ((11, 32), 0.0),
    ((11, 33), 0.0),
    ((12, 13), 3.0),
    ((12, 14), 0.0),
    ((12, 15), 0.0),
    ((12, 16), 0.0),
    ((12, 17), 1.0),
    ((12, 18), 0.0),
    ((12, 19), 1.0),
    ((12, 20), 0.0),
    ((12, 21), 1.0),
    ((12, 22), 0.0),
    ((12, 23), 0.0),
    ((12, 24), 0.0),
    ((12, 25), 0.0),
    ((12, 26), 0.0),
    ((12, 27), 0.0),
    ((12, 28), 0.0),
    ((12, 29), 0.0),
    ((12, 30), 0.0),
    ((12, 31), 1.0),
    ((12, 32), 0.0),
    ((12, 33), 0.0),
    ((13, 14), 1.0),
    ((13, 15), 1.0),
    ((13, 16), 0.0),
    ((13, 17), 3.0),
    ((13, 18), 1.0),
    ((13, 19), 3.0),
    ((13, 20), 1.0),
    ((13, 21), 3.0),
    ((13, 22), 1.0),
    ((13, 23), 1.0),
    ((13, 24), 0.0),
    ((13, 25), 0.0),
    ((13, 26), 1.0),
    ((13, 27), 2.0),
    ((13, 28), 2.0),
    ((13, 29), 1.0),
    ((13, 30), 2.0),
    ((13, 31), 2.0),
    ((13, 32), 2.0),
    ((14, 15), 4.0),
    ((14, 16), 0.0),
    ((14, 17), 0.0),
    ((14, 18), 4.0),
    ((14, 19), 1.0),
    ((14, 20), 4.0),
    ((14, 21), 0.0),
    ((14, 22), 4.0),
    ((14, 23), 4.0),
    ((14, 24), 0.0),
    ((14, 25), 0.0),
    ((14, 26), 2.0),
    ((14, 27), 2.0),
    ((14, 28), 2.0),
    ((14, 29), 4.0),
    ((14, 30), 4.0),
    ((14, 31), 4.0),
    ((15, 16), 0.0),
    ((15, 17), 0.0),
    ((15, 18), 4.0),
    ((15, 19), 1.0),
    ((15, 20), 4.0),
    ((15, 21), 0.0),
    ((15, 22), 4.0),
    ((15, 23), 4.0),
    ((15, 24), 0.0),
    ((15, 25), 0.0),
    ((15, 26), 2.0),
    ((15, 27), 2.0),
    ((15, 28), 2.0),
    ((15, 29), 4.0),
    ((15, 30), 4.0),
    ((15, 31), 4.0),
    ((16, 17), 0.0),
    ((16, 18), 0.0),
    ((16, 19), 0.0),
    ((16, 20), 0.0),
    ((16, 21), 0.0),
    ((16, 22), 0.0),
    ((16, 23), 0.0),
    ((16, 24), 0.0),
    ((16, 25), 0.0),
    ((16, 26), 0.0),
    ((16, 27), 0.0),
    ((16, 28), 0.0),
    ((16, 29), 0.0),
    ((16, 30), 0.0),
    ((16, 31), 0.0),
    ((16, 32), 0.0),
    ((16, 33), 0.0),
    ((17, 18), 0.0),
    ((17, 19), 2.0),
    ((17, 20), 0.0),
    ((17, 21), 3.0),
    ((17, 22), 0.0),
    ((17, 23), 0.0),
    ((17, 24), 0.0),
    ((17, 25), 0.0),
    ((17, 26), 0.0),
    ((17, 27), 0.0),
    ((17, 28), 0.0),
    ((17, 29), 0.0),
    ((17, 30), 1.0),
    ((17, 31), 1.0),
    ((17, 32), 0.0),
    ((17, 33), 0.0),
    ((18, 19), 1.0),
    ((18, 20), 4.0),
    ((18, 21), 0.0),
    ((18, 22), 4.0),
    ((18, 23), 4.0),
    ((18, 24), 0.0),
    ((18, 25), 0.0),
    ((18, 26), 2.0),
    ((18, 27), 2.0),
    ((18, 28), 2.0),
    ((18, 29), 4.0),
    ((18, 30), 4.0),
    ((18, 31), 4.0),
    ((19, 20), 1.0),
    ((19, 21), 2.0),
    ((19, 22), 1.0),
    ((19, 23), 1.0),
    ((19, 24), 0.0),
    ((19, 25), 0.0),
    ((19, 26), 1.0),
    ((19, 27), 1.0),
    ((19, 28), 1.0),
    ((19, 29), 1.0),
    ((19, 30), 2.0),
    ((19, 31), 2.0),
    ((19, 32), 1.0),
    ((20, 21), 0.0),
    ((20, 22), 4.0),
    ((20, 23), 4.0),
    ((20, 24), 0.0),
    ((20, 25), 0.0),
    ((20, 26), 2.0),
    ((20, 27), 2.0),
    ((20, 28), 2.0),
    ((20, 29), 4.0),
    ((20, 30), 4.0),
    ((20, 31), 4.0),
    ((21, 22), 0.0),
    ((21, 23), 0.0),
    ((21, 24), 0.0),
    ((21, 25), 0.0),
    ((21, 26), 0.0),
    ((21, 27), 0.0),
    ((21, 28), 0.0),
    ((21, 29), 0.0),
    ((21, 30), 1.0),
    ((21, 31), 1.0),
    ((21, 32), 0.0),
    ((21, 33), 0.0),
    ((22, 23), 4.0),
    ((22, 24), 0.0),
    ((22, 25), 0.0),
    ((22, 26), 2.0),
    ((22, 27), 2.0),
    ((22, 28), 2.0),
    ((22, 29), 4.0),
    ((22, 30), 4.0),
    ((22, 31), 4.0),
    ((23, 24), 4.0),
    ((23, 26), 4.0),
    ((23, 28), 2.0),
    ((23, 30), 4.0),
    ((23, 31), 6.0),
    ((24, 26), 0.0),
    ((24, 28), 2.0),
    ((24, 29), 0.0),
    ((24, 30), 0.0),
    ((24, 32), 2.0),
    ((24, 33), 4.0),
    ((25, 26), 0.0),
    ((25, 27), 4.0),
    ((25, 28), 2.0),
    ((25, 29), 2.0),
    ((25, 30), 0.0),
    ((25, 32), 4.0),
    ((25, 33), 4.0),
    ((26, 27), 2.0),
    ((26, 28), 2.0),
    ((26, 30), 2.0),
    ((26, 31), 2.0),
    ((26, 32), 4.0),
    ((27, 28), 3.0),
    ((27, 29), 4.0),
    ((27, 30), 2.0),
    ((27, 31), 4.0),
    ((27, 32), 5.0),
    ((28, 29), 2.0),
    ((28, 30), 2.0),
    ((28, 32), 5.0),
    ((29, 30), 4.0),
    ((29, 31), 4.0),
    ((30, 31), 4.0),
  ]
  for i in 0..<len(got):
    check (got[i].edge == expected[i].edge and equal(got[i].prediction, expected[i].prediction)) == true

test "ra index soundarajan hopcroft":
  let karate = karateClubGraph()
  let community = {
    0: 0, 1: 1, 2: 1, 3: 1, 4: 0, 5: 0, 6: 0, 7: 1, 8: 2, 9: 1,
    10: 0, 11: 0, 12: 1, 13: 1, 14: 2, 15: 2, 16: 0, 17: 1, 18: 2, 19: 0,
    20: 2, 21: 1, 22: 2, 23: 2, 24: 2, 25: 2, 26: 2, 27: 2, 28: 2, 29: 2,
    30: 2, 31: 2, 32: 2, 33: 2,
  }.toTable()
  let got = raIndexSoundarajanHopcroft(karate, community)
  let expected: seq[tuple[edge: Edge, prediction: float]] = @[
    ((0, 9), 0.0),
    ((0, 14), 0.0),
    ((0, 15), 0.0),
    ((0, 16), 0.5),
    ((0, 18), 0.0),
    ((0, 20), 0.0),
    ((0, 22), 0.0),
    ((0, 23), 0.0),
    ((0, 24), 0.0),
    ((0, 25), 0.0),
    ((0, 26), 0.0),
    ((0, 27), 0.0),
    ((0, 28), 0.0),
    ((0, 29), 0.0),
    ((0, 30), 0.0),
    ((0, 32), 0.0),
    ((0, 33), 0.0),
    ((1, 4), 0.0),
    ((1, 5), 0.0),
    ((1, 6), 0.0),
    ((1, 8), 0.0),
    ((1, 9), 0.1),
    ((1, 10), 0.0),
    ((1, 11), 0.0),
    ((1, 12), 0.16666666666666666),
    ((1, 14), 0.0),
    ((1, 15), 0.0),
    ((1, 16), 0.0),
    ((1, 18), 0.0),
    ((1, 20), 0.0),
    ((1, 22), 0.0),
    ((1, 23), 0.0),
    ((1, 24), 0.0),
    ((1, 25), 0.0),
    ((1, 26), 0.0),
    ((1, 27), 0.0),
    ((1, 28), 0.0),
    ((1, 29), 0.0),
    ((1, 31), 0.0),
    ((1, 32), 0.0),
    ((1, 33), 0.0),
    ((2, 4), 0.0),
    ((2, 5), 0.0),
    ((2, 6), 0.0),
    ((2, 10), 0.0),
    ((2, 11), 0.0),
    ((2, 12), 0.16666666666666666),
    ((2, 14), 0.0),
    ((2, 15), 0.0),
    ((2, 16), 0.0),
    ((2, 17), 0.1111111111111111),
    ((2, 18), 0.0),
    ((2, 19), 0.0),
    ((2, 20), 0.0),
    ((2, 21), 0.1111111111111111),
    ((2, 22), 0.0),
    ((2, 23), 0.0),
    ((2, 24), 0.0),
    ((2, 25), 0.0),
    ((2, 26), 0.0),
    ((2, 29), 0.0),
    ((2, 30), 0.0),
    ((2, 31), 0.0),
    ((2, 33), 0.0),
    ((3, 4), 0.0),
    ((3, 5), 0.0),
    ((3, 6), 0.0),
    ((3, 8), 0.0),
    ((3, 9), 0.1),
    ((3, 10), 0.0),
    ((3, 11), 0.0),
    ((3, 14), 0.0),
    ((3, 15), 0.0),
    ((3, 16), 0.0),
    ((3, 17), 0.1111111111111111),
    ((3, 18), 0.0),
    ((3, 19), 0.0),
    ((3, 20), 0.0),
    ((3, 21), 0.1111111111111111),
    ((3, 22), 0.0),
    ((3, 23), 0.0),
    ((3, 24), 0.0),
    ((3, 25), 0.0),
    ((3, 26), 0.0),
    ((3, 27), 0.0),
    ((3, 28), 0.0),
    ((3, 29), 0.0),
    ((3, 30), 0.0),
    ((3, 31), 0.0),
    ((3, 32), 0.0),
    ((3, 33), 0.0),
    ((4, 5), 0.6458333333333333),
    ((4, 7), 0.0),
    ((4, 8), 0.0),
    ((4, 9), 0.0),
    ((4, 11), 0.0625),
    ((4, 12), 0.0),
    ((4, 13), 0.0),
    ((4, 14), 0.0),
    ((4, 15), 0.0),
    ((4, 16), 0.25),
    ((4, 17), 0.0),
    ((4, 18), 0.0),
    ((4, 19), 0.0625),
    ((4, 20), 0.0),
    ((4, 21), 0.0),
    ((4, 22), 0.0),
    ((4, 23), 0.0),
    ((4, 24), 0.0),
    ((4, 25), 0.0),
    ((4, 26), 0.0),
    ((4, 27), 0.0),
    ((4, 28), 0.0),
    ((4, 29), 0.0),
    ((4, 30), 0.0),
    ((4, 31), 0.0),
    ((4, 32), 0.0),
    ((4, 33), 0.0),
    ((5, 7), 0.0),
    ((5, 8), 0.0),
    ((5, 9), 0.0),
    ((5, 11), 0.0625),
    ((5, 12), 0.0),
    ((5, 13), 0.0),
    ((5, 14), 0.0),
    ((5, 15), 0.0),
    ((5, 17), 0.0),
    ((5, 18), 0.0),
    ((5, 19), 0.0625),
    ((5, 20), 0.0),
    ((5, 21), 0.0),
    ((5, 22), 0.0),
    ((5, 23), 0.0),
    ((5, 24), 0.0),
    ((5, 25), 0.0),
    ((5, 26), 0.0),
    ((5, 27), 0.0),
    ((5, 28), 0.0),
    ((5, 29), 0.0),
    ((5, 30), 0.0),
    ((5, 31), 0.0),
    ((5, 32), 0.0),
    ((5, 33), 0.0),
    ((6, 7), 0.0),
    ((6, 8), 0.0),
    ((6, 9), 0.0),
    ((6, 10), 0.6458333333333333),
    ((6, 11), 0.0625),
    ((6, 12), 0.0),
    ((6, 13), 0.0),
    ((6, 14), 0.0),
    ((6, 15), 0.0),
    ((6, 17), 0.0),
    ((6, 18), 0.0),
    ((6, 19), 0.0625),
    ((6, 20), 0.0),
    ((6, 21), 0.0),
    ((6, 22), 0.0),
    ((6, 23), 0.0),
    ((6, 24), 0.0),
    ((6, 25), 0.0),
    ((6, 26), 0.0),
    ((6, 27), 0.0),
    ((6, 28), 0.0),
    ((6, 29), 0.0),
    ((6, 30), 0.0),
    ((6, 31), 0.0),
    ((6, 32), 0.0),
    ((6, 33), 0.0),
    ((7, 8), 0.0),
    ((7, 9), 0.1),
    ((7, 10), 0.0),
    ((7, 11), 0.0),
    ((7, 12), 0.16666666666666666),
    ((7, 13), 0.37777777777777777),
    ((7, 14), 0.0),
    ((7, 15), 0.0),
    ((7, 16), 0.0),
    ((7, 17), 0.1111111111111111),
    ((7, 18), 0.0),
    ((7, 19), 0.0),
    ((7, 20), 0.0),
    ((7, 21), 0.1111111111111111),
    ((7, 22), 0.0),
    ((7, 23), 0.0),
    ((7, 24), 0.0),
    ((7, 25), 0.0),
    ((7, 26), 0.0),
    ((7, 27), 0.0),
    ((7, 28), 0.0),
    ((7, 29), 0.0),
    ((7, 30), 0.0),
    ((7, 31), 0.0),
    ((7, 32), 0.0),
    ((7, 33), 0.0),
    ((8, 9), 0.0),
    ((8, 10), 0.0),
    ((8, 11), 0.0),
    ((8, 12), 0.0),
    ((8, 13), 0.0),
    ((8, 14), 0.14215686274509803),
    ((8, 15), 0.14215686274509803),
    ((8, 16), 0.0),
    ((8, 17), 0.0),
    ((8, 18), 0.14215686274509803),
    ((8, 19), 0.0),
    ((8, 20), 0.14215686274509803),
    ((8, 21), 0.0),
    ((8, 22), 0.14215686274509803),
    ((8, 23), 0.14215686274509803),
    ((8, 24), 0.0),
    ((8, 25), 0.0),
    ((8, 26), 0.058823529411764705),
    ((8, 27), 0.058823529411764705),
    ((8, 28), 0.058823529411764705),
    ((8, 29), 0.14215686274509803),
    ((8, 31), 0.14215686274509803),
    ((9, 10), 0.0),
    ((9, 11), 0.0),
    ((9, 12), 0.0),
    ((9, 13), 0.1),
    ((9, 14), 0.0),
    ((9, 15), 0.0),
    ((9, 16), 0.0),
    ((9, 17), 0.0),
    ((9, 18), 0.0),
    ((9, 19), 0.0),
    ((9, 20), 0.0),
    ((9, 21), 0.0),
    ((9, 22), 0.0),
    ((9, 23), 0.0),
    ((9, 24), 0.0),
    ((9, 25), 0.0),
    ((9, 26), 0.0),
    ((9, 27), 0.0),
    ((9, 28), 0.0),
    ((9, 29), 0.0),
    ((9, 30), 0.0),
    ((9, 31), 0.0),
    ((9, 32), 0.0),
    ((10, 11), 0.0625),
    ((10, 12), 0.0),
    ((10, 13), 0.0),
    ((10, 14), 0.0),
    ((10, 15), 0.0),
    ((10, 16), 0.25),
    ((10, 17), 0.0),
    ((10, 18), 0.0),
    ((10, 19), 0.0625),
    ((10, 20), 0.0),
    ((10, 21), 0.0),
    ((10, 22), 0.0),
    ((10, 23), 0.0),
    ((10, 24), 0.0),
    ((10, 25), 0.0),
    ((10, 26), 0.0),
    ((10, 27), 0.0),
    ((10, 28), 0.0),
    ((10, 29), 0.0),
    ((10, 30), 0.0),
    ((10, 31), 0.0),
    ((10, 32), 0.0),
    ((10, 33), 0.0),
    ((11, 12), 0.0),
    ((11, 13), 0.0),
    ((11, 14), 0.0),
    ((11, 15), 0.0),
    ((11, 16), 0.0),
    ((11, 17), 0.0),
    ((11, 18), 0.0),
    ((11, 19), 0.0625),
    ((11, 20), 0.0),
    ((11, 21), 0.0),
    ((11, 22), 0.0),
    ((11, 23), 0.0),
    ((11, 24), 0.0),
    ((11, 25), 0.0),
    ((11, 26), 0.0),
    ((11, 27), 0.0),
    ((11, 28), 0.0),
    ((11, 29), 0.0),
    ((11, 30), 0.0),
    ((11, 31), 0.0),
    ((11, 32), 0.0),
    ((11, 33), 0.0),
    ((12, 13), 0.16666666666666666),
    ((12, 14), 0.0),
    ((12, 15), 0.0),
    ((12, 16), 0.0),
    ((12, 17), 0.0),
    ((12, 18), 0.0),
    ((12, 19), 0.0),
    ((12, 20), 0.0),
    ((12, 21), 0.0),
    ((12, 22), 0.0),
    ((12, 23), 0.0),
    ((12, 24), 0.0),
    ((12, 25), 0.0),
    ((12, 26), 0.0),
    ((12, 27), 0.0),
    ((12, 28), 0.0),
    ((12, 29), 0.0),
    ((12, 30), 0.0),
    ((12, 31), 0.0),
    ((12, 32), 0.0),
    ((12, 33), 0.0),
    ((13, 14), 0.0),
    ((13, 15), 0.0),
    ((13, 16), 0.0),
    ((13, 17), 0.1111111111111111),
    ((13, 18), 0.0),
    ((13, 19), 0.0),
    ((13, 20), 0.0),
    ((13, 21), 0.1111111111111111),
    ((13, 22), 0.0),
    ((13, 23), 0.0),
    ((13, 24), 0.0),
    ((13, 25), 0.0),
    ((13, 26), 0.0),
    ((13, 27), 0.0),
    ((13, 28), 0.0),
    ((13, 29), 0.0),
    ((13, 30), 0.0),
    ((13, 31), 0.0),
    ((13, 32), 0.0),
    ((14, 15), 0.14215686274509803),
    ((14, 16), 0.0),
    ((14, 17), 0.0),
    ((14, 18), 0.14215686274509803),
    ((14, 19), 0.0),
    ((14, 20), 0.14215686274509803),
    ((14, 21), 0.0),
    ((14, 22), 0.14215686274509803),
    ((14, 23), 0.14215686274509803),
    ((14, 24), 0.0),
    ((14, 25), 0.0),
    ((14, 26), 0.058823529411764705),
    ((14, 27), 0.058823529411764705),
    ((14, 28), 0.058823529411764705),
    ((14, 29), 0.14215686274509803),
    ((14, 30), 0.14215686274509803),
    ((14, 31), 0.14215686274509803),
    ((15, 16), 0.0),
    ((15, 17), 0.0),
    ((15, 18), 0.14215686274509803),
    ((15, 19), 0.0),
    ((15, 20), 0.14215686274509803),
    ((15, 21), 0.0),
    ((15, 22), 0.14215686274509803),
    ((15, 23), 0.14215686274509803),
    ((15, 24), 0.0),
    ((15, 25), 0.0),
    ((15, 26), 0.058823529411764705),
    ((15, 27), 0.058823529411764705),
    ((15, 28), 0.058823529411764705),
    ((15, 29), 0.14215686274509803),
    ((15, 30), 0.14215686274509803),
    ((15, 31), 0.14215686274509803),
    ((16, 17), 0.0),
    ((16, 18), 0.0),
    ((16, 19), 0.0),
    ((16, 20), 0.0),
    ((16, 21), 0.0),
    ((16, 22), 0.0),
    ((16, 23), 0.0),
    ((16, 24), 0.0),
    ((16, 25), 0.0),
    ((16, 26), 0.0),
    ((16, 27), 0.0),
    ((16, 28), 0.0),
    ((16, 29), 0.0),
    ((16, 30), 0.0),
    ((16, 31), 0.0),
    ((16, 32), 0.0),
    ((16, 33), 0.0),
    ((17, 18), 0.0),
    ((17, 19), 0.0),
    ((17, 20), 0.0),
    ((17, 21), 0.1111111111111111),
    ((17, 22), 0.0),
    ((17, 23), 0.0),
    ((17, 24), 0.0),
    ((17, 25), 0.0),
    ((17, 26), 0.0),
    ((17, 27), 0.0),
    ((17, 28), 0.0),
    ((17, 29), 0.0),
    ((17, 30), 0.0),
    ((17, 31), 0.0),
    ((17, 32), 0.0),
    ((17, 33), 0.0),
    ((18, 19), 0.0),
    ((18, 20), 0.14215686274509803),
    ((18, 21), 0.0),
    ((18, 22), 0.14215686274509803),
    ((18, 23), 0.14215686274509803),
    ((18, 24), 0.0),
    ((18, 25), 0.0),
    ((18, 26), 0.058823529411764705),
    ((18, 27), 0.058823529411764705),
    ((18, 28), 0.058823529411764705),
    ((18, 29), 0.14215686274509803),
    ((18, 30), 0.14215686274509803),
    ((18, 31), 0.14215686274509803),
    ((19, 20), 0.0),
    ((19, 21), 0.0),
    ((19, 22), 0.0),
    ((19, 23), 0.0),
    ((19, 24), 0.0),
    ((19, 25), 0.0),
    ((19, 26), 0.0),
    ((19, 27), 0.0),
    ((19, 28), 0.0),
    ((19, 29), 0.0),
    ((19, 30), 0.0),
    ((19, 31), 0.0),
    ((19, 32), 0.0),
    ((20, 21), 0.0),
    ((20, 22), 0.14215686274509803),
    ((20, 23), 0.14215686274509803),
    ((20, 24), 0.0),
    ((20, 25), 0.0),
    ((20, 26), 0.058823529411764705),
    ((20, 27), 0.058823529411764705),
    ((20, 28), 0.058823529411764705),
    ((20, 29), 0.14215686274509803),
    ((20, 30), 0.14215686274509803),
    ((20, 31), 0.14215686274509803),
    ((21, 22), 0.0),
    ((21, 23), 0.0),
    ((21, 24), 0.0),
    ((21, 25), 0.0),
    ((21, 26), 0.0),
    ((21, 27), 0.0),
    ((21, 28), 0.0),
    ((21, 29), 0.0),
    ((21, 30), 0.0),
    ((21, 31), 0.0),
    ((21, 32), 0.0),
    ((21, 33), 0.0),
    ((22, 23), 0.14215686274509803),
    ((22, 24), 0.0),
    ((22, 25), 0.0),
    ((22, 26), 0.058823529411764705),
    ((22, 27), 0.058823529411764705),
    ((22, 28), 0.058823529411764705),
    ((22, 29), 0.14215686274509803),
    ((22, 30), 0.14215686274509803),
    ((22, 31), 0.14215686274509803),
    ((23, 24), 0.5833333333333333),
    ((23, 26), 0.3088235294117647),
    ((23, 28), 0.058823529411764705),
    ((23, 30), 0.14215686274509803),
    ((23, 31), 0.47549019607843135),
    ((24, 26), 0.0),
    ((24, 28), 0.16666666666666666),
    ((24, 29), 0.0),
    ((24, 30), 0.0),
    ((24, 32), 0.16666666666666666),
    ((24, 33), 0.41666666666666663),
    ((25, 26), 0.0),
    ((25, 27), 0.5333333333333333),
    ((25, 28), 0.16666666666666666),
    ((25, 29), 0.2),
    ((25, 30), 0.0),
    ((25, 32), 0.3666666666666667),
    ((25, 33), 0.3666666666666667),
    ((26, 27), 0.058823529411764705),
    ((26, 28), 0.058823529411764705),
    ((26, 30), 0.058823529411764705),
    ((26, 31), 0.058823529411764705),
    ((26, 32), 0.3088235294117647),
    ((27, 28), 0.058823529411764705),
    ((27, 29), 0.25882352941176473),
    ((27, 30), 0.058823529411764705),
    ((27, 31), 0.39215686274509803),
    ((27, 32), 0.25882352941176473),
    ((28, 29), 0.058823529411764705),
    ((28, 30), 0.058823529411764705),
    ((28, 32), 0.22549019607843135),
    ((29, 30), 0.14215686274509803),
    ((29, 31), 0.14215686274509803),
    ((30, 31), 0.14215686274509803),
  ]
  for i in 0..<len(got):
    check (got[i].edge == expected[i].edge and equal(got[i].prediction, expected[i].prediction)) == true

test "within inter cluster":
  let karate = karateClubGraph()
  let community = {
    0: 0, 1: 1, 2: 1, 3: 1, 4: 0, 5: 0, 6: 0, 7: 1, 8: 2, 9: 1,
    10: 0, 11: 0, 12: 1, 13: 1, 14: 2, 15: 2, 16: 0, 17: 1, 18: 2, 19: 0,
    20: 2, 21: 1, 22: 2, 23: 2, 24: 2, 25: 2, 26: 2, 27: 2, 28: 2, 29: 2,
    30: 2, 31: 2, 32: 2, 33: 2,
  }.toTable()
  let got = withinInterCluster(karate, community)
  let expected: seq[tuple[edge: Edge, prediction: float]] = @[
    ((0, 9), 0.0),
    ((0, 14), 0.0),
    ((0, 15), 0.0),
    ((0, 16), 2000.0),
    ((0, 18), 0.0),
    ((0, 20), 0.0),
    ((0, 22), 0.0),
    ((0, 23), 0.0),
    ((0, 24), 0.0),
    ((0, 25), 0.0),
    ((0, 26), 0.0),
    ((0, 27), 0.0),
    ((0, 28), 0.0),
    ((0, 29), 0.0),
    ((0, 30), 0.0),
    ((0, 32), 0.0),
    ((0, 33), 0.0),
    ((1, 4), 0.0),
    ((1, 5), 0.0),
    ((1, 6), 0.0),
    ((1, 8), 0.0),
    ((1, 9), 1000.0),
    ((1, 10), 0.0),
    ((1, 11), 0.0),
    ((1, 12), 0.9990009990009991),
    ((1, 14), 0.0),
    ((1, 15), 0.0),
    ((1, 16), 0.0),
    ((1, 18), 0.0),
    ((1, 20), 0.0),
    ((1, 22), 0.0),
    ((1, 23), 0.0),
    ((1, 24), 0.0),
    ((1, 25), 0.0),
    ((1, 26), 0.0),
    ((1, 27), 0.0),
    ((1, 28), 0.0),
    ((1, 29), 0.0),
    ((1, 31), 0.0),
    ((1, 32), 0.0),
    ((1, 33), 0.0),
    ((2, 4), 0.0),
    ((2, 5), 0.0),
    ((2, 6), 0.0),
    ((2, 10), 0.0),
    ((2, 11), 0.0),
    ((2, 12), 0.9990009990009991),
    ((2, 14), 0.0),
    ((2, 15), 0.0),
    ((2, 16), 0.0),
    ((2, 17), 0.9990009990009991),
    ((2, 18), 0.0),
    ((2, 19), 0.0),
    ((2, 20), 0.0),
    ((2, 21), 0.9990009990009991),
    ((2, 22), 0.0),
    ((2, 23), 0.0),
    ((2, 24), 0.0),
    ((2, 25), 0.0),
    ((2, 26), 0.0),
    ((2, 29), 0.0),
    ((2, 30), 0.0),
    ((2, 31), 0.0),
    ((2, 33), 0.0),
    ((3, 4), 0.0),
    ((3, 5), 0.0),
    ((3, 6), 0.0),
    ((3, 8), 0.0),
    ((3, 9), 1000.0),
    ((3, 10), 0.0),
    ((3, 11), 0.0),
    ((3, 14), 0.0),
    ((3, 15), 0.0),
    ((3, 16), 0.0),
    ((3, 17), 0.9990009990009991),
    ((3, 18), 0.0),
    ((3, 19), 0.0),
    ((3, 20), 0.0),
    ((3, 21), 0.9990009990009991),
    ((3, 22), 0.0),
    ((3, 23), 0.0),
    ((3, 24), 0.0),
    ((3, 25), 0.0),
    ((3, 26), 0.0),
    ((3, 27), 0.0),
    ((3, 28), 0.0),
    ((3, 29), 0.0),
    ((3, 30), 0.0),
    ((3, 31), 0.0),
    ((3, 32), 0.0),
    ((3, 33), 0.0),
    ((4, 5), 3000.0),
    ((4, 7), 0.0),
    ((4, 8), 0.0),
    ((4, 9), 0.0),
    ((4, 11), 1000.0),
    ((4, 12), 0.0),
    ((4, 13), 0.0),
    ((4, 14), 0.0),
    ((4, 15), 0.0),
    ((4, 16), 1000.0),
    ((4, 17), 0.0),
    ((4, 18), 0.0),
    ((4, 19), 1000.0),
    ((4, 20), 0.0),
    ((4, 21), 0.0),
    ((4, 22), 0.0),
    ((4, 23), 0.0),
    ((4, 24), 0.0),
    ((4, 25), 0.0),
    ((4, 26), 0.0),
    ((4, 27), 0.0),
    ((4, 28), 0.0),
    ((4, 29), 0.0),
    ((4, 30), 0.0),
    ((4, 31), 0.0),
    ((4, 32), 0.0),
    ((4, 33), 0.0),
    ((5, 7), 0.0),
    ((5, 8), 0.0),
    ((5, 9), 0.0),
    ((5, 11), 1000.0),
    ((5, 12), 0.0),
    ((5, 13), 0.0),
    ((5, 14), 0.0),
    ((5, 15), 0.0),
    ((5, 17), 0.0),
    ((5, 18), 0.0),
    ((5, 19), 1000.0),
    ((5, 20), 0.0),
    ((5, 21), 0.0),
    ((5, 22), 0.0),
    ((5, 23), 0.0),
    ((5, 24), 0.0),
    ((5, 25), 0.0),
    ((5, 26), 0.0),
    ((5, 27), 0.0),
    ((5, 28), 0.0),
    ((5, 29), 0.0),
    ((5, 30), 0.0),
    ((5, 31), 0.0),
    ((5, 32), 0.0),
    ((5, 33), 0.0),
    ((6, 7), 0.0),
    ((6, 8), 0.0),
    ((6, 9), 0.0),
    ((6, 10), 3000.0),
    ((6, 11), 1000.0),
    ((6, 12), 0.0),
    ((6, 13), 0.0),
    ((6, 14), 0.0),
    ((6, 15), 0.0),
    ((6, 17), 0.0),
    ((6, 18), 0.0),
    ((6, 19), 1000.0),
    ((6, 20), 0.0),
    ((6, 21), 0.0),
    ((6, 22), 0.0),
    ((6, 23), 0.0),
    ((6, 24), 0.0),
    ((6, 25), 0.0),
    ((6, 26), 0.0),
    ((6, 27), 0.0),
    ((6, 28), 0.0),
    ((6, 29), 0.0),
    ((6, 30), 0.0),
    ((6, 31), 0.0),
    ((6, 32), 0.0),
    ((6, 33), 0.0),
    ((7, 8), 0.0),
    ((7, 9), 1000.0),
    ((7, 10), 0.0),
    ((7, 11), 0.0),
    ((7, 12), 0.9990009990009991),
    ((7, 13), 2.997002997002997),
    ((7, 14), 0.0),
    ((7, 15), 0.0),
    ((7, 16), 0.0),
    ((7, 17), 0.9990009990009991),
    ((7, 18), 0.0),
    ((7, 19), 0.0),
    ((7, 20), 0.0),
    ((7, 21), 0.9990009990009991),
    ((7, 22), 0.0),
    ((7, 23), 0.0),
    ((7, 24), 0.0),
    ((7, 25), 0.0),
    ((7, 26), 0.0),
    ((7, 27), 0.0),
    ((7, 28), 0.0),
    ((7, 29), 0.0),
    ((7, 30), 0.0),
    ((7, 31), 0.0),
    ((7, 32), 0.0),
    ((7, 33), 0.0),
    ((8, 9), 0.0),
    ((8, 10), 0.0),
    ((8, 11), 0.0),
    ((8, 12), 0.0),
    ((8, 13), 0.0),
    ((8, 14), 2000.0),
    ((8, 15), 2000.0),
    ((8, 16), 0.0),
    ((8, 17), 0.0),
    ((8, 18), 2000.0),
    ((8, 19), 0.0),
    ((8, 20), 2000.0),
    ((8, 21), 0.0),
    ((8, 22), 2000.0),
    ((8, 23), 2000.0),
    ((8, 24), 0.0),
    ((8, 25), 0.0),
    ((8, 26), 1000.0),
    ((8, 27), 0.9990009990009991),
    ((8, 28), 0.9990009990009991),
    ((8, 29), 2000.0),
    ((8, 31), 1.9980019980019983),
    ((9, 10), 0.0),
    ((9, 11), 0.0),
    ((9, 12), 0.0),
    ((9, 13), 0.9990009990009991),
    ((9, 14), 0.0),
    ((9, 15), 0.0),
    ((9, 16), 0.0),
    ((9, 17), 0.0),
    ((9, 18), 0.0),
    ((9, 19), 0.0),
    ((9, 20), 0.0),
    ((9, 21), 0.0),
    ((9, 22), 0.0),
    ((9, 23), 0.0),
    ((9, 24), 0.0),
    ((9, 25), 0.0),
    ((9, 26), 0.0),
    ((9, 27), 0.0),
    ((9, 28), 0.0),
    ((9, 29), 0.0),
    ((9, 30), 0.0),
    ((9, 31), 0.0),
    ((9, 32), 0.0),
    ((10, 11), 1000.0),
    ((10, 12), 0.0),
    ((10, 13), 0.0),
    ((10, 14), 0.0),
    ((10, 15), 0.0),
    ((10, 16), 1000.0),
    ((10, 17), 0.0),
    ((10, 18), 0.0),
    ((10, 19), 1000.0),
    ((10, 20), 0.0),
    ((10, 21), 0.0),
    ((10, 22), 0.0),
    ((10, 23), 0.0),
    ((10, 24), 0.0),
    ((10, 25), 0.0),
    ((10, 26), 0.0),
    ((10, 27), 0.0),
    ((10, 28), 0.0),
    ((10, 29), 0.0),
    ((10, 30), 0.0),
    ((10, 31), 0.0),
    ((10, 32), 0.0),
    ((10, 33), 0.0),
    ((11, 12), 0.0),
    ((11, 13), 0.0),
    ((11, 14), 0.0),
    ((11, 15), 0.0),
    ((11, 16), 0.0),
    ((11, 17), 0.0),
    ((11, 18), 0.0),
    ((11, 19), 1000.0),
    ((11, 20), 0.0),
    ((11, 21), 0.0),
    ((11, 22), 0.0),
    ((11, 23), 0.0),
    ((11, 24), 0.0),
    ((11, 25), 0.0),
    ((11, 26), 0.0),
    ((11, 27), 0.0),
    ((11, 28), 0.0),
    ((11, 29), 0.0),
    ((11, 30), 0.0),
    ((11, 31), 0.0),
    ((11, 32), 0.0),
    ((11, 33), 0.0),
    ((12, 13), 0.9990009990009991),
    ((12, 14), 0.0),
    ((12, 15), 0.0),
    ((12, 16), 0.0),
    ((12, 17), 0.0),
    ((12, 18), 0.0),
    ((12, 19), 0.0),
    ((12, 20), 0.0),
    ((12, 21), 0.0),
    ((12, 22), 0.0),
    ((12, 23), 0.0),
    ((12, 24), 0.0),
    ((12, 25), 0.0),
    ((12, 26), 0.0),
    ((12, 27), 0.0),
    ((12, 28), 0.0),
    ((12, 29), 0.0),
    ((12, 30), 0.0),
    ((12, 31), 0.0),
    ((12, 32), 0.0),
    ((12, 33), 0.0),
    ((13, 14), 0.0),
    ((13, 15), 0.0),
    ((13, 16), 0.0),
    ((13, 17), 0.9990009990009991),
    ((13, 18), 0.0),
    ((13, 19), 0.0),
    ((13, 20), 0.0),
    ((13, 21), 0.9990009990009991),
    ((13, 22), 0.0),
    ((13, 23), 0.0),
    ((13, 24), 0.0),
    ((13, 25), 0.0),
    ((13, 26), 0.0),
    ((13, 27), 0.0),
    ((13, 28), 0.0),
    ((13, 29), 0.0),
    ((13, 30), 0.0),
    ((13, 31), 0.0),
    ((13, 32), 0.0),
    ((14, 15), 2000.0),
    ((14, 16), 0.0),
    ((14, 17), 0.0),
    ((14, 18), 2000.0),
    ((14, 19), 0.0),
    ((14, 20), 2000.0),
    ((14, 21), 0.0),
    ((14, 22), 2000.0),
    ((14, 23), 2000.0),
    ((14, 24), 0.0),
    ((14, 25), 0.0),
    ((14, 26), 1000.0),
    ((14, 27), 1000.0),
    ((14, 28), 1000.0),
    ((14, 29), 2000.0),
    ((14, 30), 2000.0),
    ((14, 31), 2000.0),
    ((15, 16), 0.0),
    ((15, 17), 0.0),
    ((15, 18), 2000.0),
    ((15, 19), 0.0),
    ((15, 20), 2000.0),
    ((15, 21), 0.0),
    ((15, 22), 2000.0),
    ((15, 23), 2000.0),
    ((15, 24), 0.0),
    ((15, 25), 0.0),
    ((15, 26), 1000.0),
    ((15, 27), 1000.0),
    ((15, 28), 1000.0),
    ((15, 29), 2000.0),
    ((15, 30), 2000.0),
    ((15, 31), 2000.0),
    ((16, 17), 0.0),
    ((16, 18), 0.0),
    ((16, 19), 0.0),
    ((16, 20), 0.0),
    ((16, 21), 0.0),
    ((16, 22), 0.0),
    ((16, 23), 0.0),
    ((16, 24), 0.0),
    ((16, 25), 0.0),
    ((16, 26), 0.0),
    ((16, 27), 0.0),
    ((16, 28), 0.0),
    ((16, 29), 0.0),
    ((16, 30), 0.0),
    ((16, 31), 0.0),
    ((16, 32), 0.0),
    ((16, 33), 0.0),
    ((17, 18), 0.0),
    ((17, 19), 0.0),
    ((17, 20), 0.0),
    ((17, 21), 0.9990009990009991),
    ((17, 22), 0.0),
    ((17, 23), 0.0),
    ((17, 24), 0.0),
    ((17, 25), 0.0),
    ((17, 26), 0.0),
    ((17, 27), 0.0),
    ((17, 28), 0.0),
    ((17, 29), 0.0),
    ((17, 30), 0.0),
    ((17, 31), 0.0),
    ((17, 32), 0.0),
    ((17, 33), 0.0),
    ((18, 19), 0.0),
    ((18, 20), 2000.0),
    ((18, 21), 0.0),
    ((18, 22), 2000.0),
    ((18, 23), 2000.0),
    ((18, 24), 0.0),
    ((18, 25), 0.0),
    ((18, 26), 1000.0),
    ((18, 27), 1000.0),
    ((18, 28), 1000.0),
    ((18, 29), 2000.0),
    ((18, 30), 2000.0),
    ((18, 31), 2000.0),
    ((19, 20), 0.0),
    ((19, 21), 0.0),
    ((19, 22), 0.0),
    ((19, 23), 0.0),
    ((19, 24), 0.0),
    ((19, 25), 0.0),
    ((19, 26), 0.0),
    ((19, 27), 0.0),
    ((19, 28), 0.0),
    ((19, 29), 0.0),
    ((19, 30), 0.0),
    ((19, 31), 0.0),
    ((19, 32), 0.0),
    ((20, 21), 0.0),
    ((20, 22), 2000.0),
    ((20, 23), 2000.0),
    ((20, 24), 0.0),
    ((20, 25), 0.0),
    ((20, 26), 1000.0),
    ((20, 27), 1000.0),
    ((20, 28), 1000.0),
    ((20, 29), 2000.0),
    ((20, 30), 2000.0),
    ((20, 31), 2000.0),
    ((21, 22), 0.0),
    ((21, 23), 0.0),
    ((21, 24), 0.0),
    ((21, 25), 0.0),
    ((21, 26), 0.0),
    ((21, 27), 0.0),
    ((21, 28), 0.0),
    ((21, 29), 0.0),
    ((21, 30), 0.0),
    ((21, 31), 0.0),
    ((21, 32), 0.0),
    ((21, 33), 0.0),
    ((22, 23), 2000.0),
    ((22, 24), 0.0),
    ((22, 25), 0.0),
    ((22, 26), 1000.0),
    ((22, 27), 1000.0),
    ((22, 28), 1000.0),
    ((22, 29), 2000.0),
    ((22, 30), 2000.0),
    ((22, 31), 2000.0),
    ((23, 24), 2000.0),
    ((23, 26), 2000.0),
    ((23, 28), 1000.0),
    ((23, 30), 2000.0),
    ((23, 31), 3000.0),
    ((24, 26), 0.0),
    ((24, 28), 1000.0),
    ((24, 29), 0.0),
    ((24, 30), 0.0),
    ((24, 32), 1000.0),
    ((24, 33), 2000.0),
    ((25, 26), 0.0),
    ((25, 27), 2000.0),
    ((25, 28), 1000.0),
    ((25, 29), 1000.0),
    ((25, 30), 0.0),
    ((25, 32), 2000.0),
    ((25, 33), 2000.0),
    ((26, 27), 1000.0),
    ((26, 28), 1000.0),
    ((26, 30), 1000.0),
    ((26, 31), 1000.0),
    ((26, 32), 2000.0),
    ((27, 28), 0.9990009990009991),
    ((27, 29), 2000.0),
    ((27, 30), 1000.0),
    ((27, 31), 2000.0),
    ((27, 32), 1.9980019980019983),
    ((28, 29), 1000.0),
    ((28, 30), 1000.0),
    ((28, 32), 1.9980019980019983),
    ((29, 30), 2000.0),
    ((29, 31), 2000.0),
    ((30, 31), 2000.0)
  ]
  for i in 0..<len(got):
    check (got[i].edge == expected[i].edge and equal(got[i].prediction, expected[i].prediction)) == true

# -------------------------------------------------------------------
# Lowest Common Ancestor
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Matching
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Minors
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Maximal Independent Set
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Non-randomness
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Moral
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Node Classification
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Operators
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Planarity
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Planar Drawing
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Reciprocity
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Regular
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Rich Club
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Shortest Paths
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Similarity Measures
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Simple Paths
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Small World
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# s-metric
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Sparsifiers
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Structual Holes
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Summarization
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Swap
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Threshold Graphs
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Tournament
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Traversal
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Tree
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Triads
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Vitality
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Voronoi cells
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Wiener Index
# -------------------------------------------------------------------