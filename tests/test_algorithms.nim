import unittest

import tables

import nimnet
import nimnet/generators
import nimnet/algorithms

const DELTA = 1e-15
proc equal(a, b: float): bool =
  if DELTA < abs(a - b):
      return false
  return true

# -------------------------------------------------------------------
# Approximations and Heuristics
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Assortativity
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Asteroidal
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Bipartite
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Boundary
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Centrality
# -------------------------------------------------------------------

test "degree centrality for undirected graph":
  let karate = karateClubGraph()
  let got = degreeCentrality(karate)
  let want = {0: 0.48484848484848486, 1: 0.2727272727272727, 2: 0.30303030303030304, 3: 0.18181818181818182, 4: 0.09090909090909091, 5: 0.12121212121212122, 6: 0.12121212121212122, 7: 0.12121212121212122, 8: 0.15151515151515152, 9: 0.06060606060606061, 10: 0.09090909090909091, 11: 0.030303030303030304, 12: 0.06060606060606061, 13: 0.15151515151515152, 14: 0.06060606060606061, 15: 0.06060606060606061, 16: 0.06060606060606061, 17: 0.06060606060606061, 18: 0.06060606060606061, 19: 0.09090909090909091, 20: 0.06060606060606061, 21: 0.06060606060606061, 22: 0.06060606060606061, 23: 0.15151515151515152, 24: 0.09090909090909091, 25: 0.09090909090909091, 26: 0.06060606060606061, 27: 0.12121212121212122, 28: 0.09090909090909091, 29: 0.12121212121212122, 30: 0.12121212121212122, 31: 0.18181818181818182, 32: 0.36363636363636365, 33: 0.5151515151515151}.toTable()
  for (node, val) in got.pairs():
    check equal(val, want[node]) == true

test "in-degree centrality for directed graph":
  let dkarate = newDiGraph(karateClubGraph().edges())
  let got = inDegreeCentrality(dkarate)
  let want = {0: 0.0, 1: 0.030303030303030304, 2: 0.06060606060606061, 3: 0.09090909090909091, 4: 0.030303030303030304, 5: 0.030303030303030304, 6: 0.09090909090909091, 7: 0.12121212121212122, 8: 0.06060606060606061, 10: 0.09090909090909091, 11: 0.030303030303030304, 12: 0.06060606060606061, 13: 0.12121212121212122, 17: 0.06060606060606061, 19: 0.06060606060606061, 21: 0.06060606060606061, 31: 0.12121212121212122, 30: 0.06060606060606061, 9: 0.030303030303030304, 27: 0.09090909090909091, 28: 0.030303030303030304, 32: 0.33333333333333337, 16: 0.06060606060606061, 33: 0.5151515151515151, 14: 0.0, 15: 0.0, 18: 0.0, 20: 0.0, 22: 0.0, 23: 0.0, 25: 0.06060606060606061, 29: 0.06060606060606061, 24: 0.0, 26: 0.0}.toTable()
  for (node, val) in got.pairs():
    check equal(val, want[node]) == true

test "out-degree centrality for directed graph":
  let dkarate = newDiGraph(karateClubGraph().edges())
  let got = outDegreeCentrality(dkarate)
  let want = {0: 0.48484848484848486, 1: 0.24242424242424243, 2: 0.24242424242424243, 3: 0.09090909090909091, 4: 0.06060606060606061, 5: 0.09090909090909091, 6: 0.030303030303030304, 7: 0.0, 8: 0.09090909090909091, 10: 0.0, 11: 0.0, 12: 0.0, 13: 0.030303030303030304, 17: 0.0, 19: 0.030303030303030304, 21: 0.0, 31: 0.06060606060606061, 30: 0.06060606060606061, 9: 0.030303030303030304, 27: 0.030303030303030304, 28: 0.06060606060606061, 32: 0.030303030303030304, 16: 0.0, 33: 0.0, 14: 0.06060606060606061, 15: 0.06060606060606061, 18: 0.06060606060606061, 20: 0.06060606060606061, 22: 0.06060606060606061, 23: 0.15151515151515152, 25: 0.030303030303030304, 29: 0.06060606060606061, 24: 0.09090909090909091, 26: 0.06060606060606061}.toTable()
  for (node, val) in got.pairs():
    check equal(val, want[node]) == true

# -------------------------------------------------------------------
# Chains
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Chordal
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Clique
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Clutering
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Coloring
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Communicability
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Communities
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Components
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Connectivity
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Cores
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Covering
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Cycle
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Cuts
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# D-Separation
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# DAG
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Distance Measures
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Distance-Regular Graphs
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Dominance
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Dominating Sets
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Efficiency
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Eulerian
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Flows
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Graph Hashing
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Graphical Degree Sequence
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Hierarchy
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Hybrid
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Isolates
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Isomorphism
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Link Analysis
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Link Prediction
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Lowest Common Ancestor
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Matching
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Minors
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Maximal Independent Set
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Non-randomness
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Moral
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Node Classification
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Operators
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Planarity
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Planar Drawing
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Reciprocity
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Regular
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Rich Club
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Shortest Paths
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Similarity Measures
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Simple Paths
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Small World
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# s-metric
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Sparsifiers
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Structual Holes
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Summarization
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Swap
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Threshold Graphs
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Tournament
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Traversal
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Tree
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Triads
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Vitality
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Voronoi cells
# -------------------------------------------------------------------

# -------------------------------------------------------------------
# Wiener Index
# -------------------------------------------------------------------